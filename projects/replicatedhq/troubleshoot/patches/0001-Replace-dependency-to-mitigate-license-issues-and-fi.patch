From 86348394500a9a1e1e166ca7669b991d688c1253 Mon Sep 17 00:00:00 2001
From: danbudris <budris@amazon.com>
Date: Fri, 3 Mar 2023 15:07:50 -0800
Subject: [PATCH] Replace dependency to mitigate license issues and fix module
 retraction

replace xi2/xz to mitigate non-standard license
The xi2/xz package, a dependency of the version of https://github.com/mholt/archiver imported by replicated/troubleshoot, uses a non-standard Public Domain license.
This replacement points to a fork which has a standard CC-0 public domain license.

github.com/andybalholm/brotli@v1.0.1 was retracted by the author due to occasional panics and data corruption,
so bumping to the latest unretracted version

Signed-off-by: Dan Budris <budris@amazon.com>
---
 go.mod | 2 ++
 go.sum | 2 ++
 2 files changed, 4 insertions(+)

diff --git a/go.mod b/go.mod
index 3dfe260c..834479c2 100644
--- a/go.mod
+++ b/go.mod
@@ -159,6 +159,7 @@ require (
 	github.com/vladimirvivien/gexe v0.4.1 // indirect
 	github.com/x448/float16 v0.8.4 // indirect
 	github.com/zeebo/errs v1.4.0 // indirect
+	github.com/xi2/xz v0.0.0-20171230120015-48954b6210f8 // indirect
 	go.opentelemetry.io/auto/sdk v1.1.0 // indirect
 	go.opentelemetry.io/contrib/detectors/gcp v1.34.0 // indirect
 	go.opentelemetry.io/contrib/instrumentation/google.golang.org/grpc/otelgrpc v0.60.0 // indirect
@@ -293,4 +294,5 @@ require (
 replace (
 	github.com/StackExchange/wmi => github.com/yusufpapurcu/wmi v1.2.2
 	github.com/go-ole/go-ole => github.com/go-ole/go-ole v1.2.6 // needed for arm builds
+	github.com/xi2/xz => github.com/therootcompany/xz v1.0.1
 )
diff --git a/go.sum b/go.sum
index c4a59b10..cfd4c6ec 100644
--- a/go.sum
+++ b/go.sum
@@ -638,6 +638,8 @@ github.com/sylabs/sif/v2 v2.21.1 h1:GZ0b5//AFAqJEChd8wHV/uSKx/l1iuGYwjR8nx+4wPI=
 github.com/sylabs/sif/v2 v2.21.1/go.mod h1:YoqEGQnb5x/ItV653bawXHZJOXQaEWpGwHsSD3YePJI=
 github.com/tchap/go-patricia/v2 v2.3.3 h1:xfNEsODumaEcCcY3gI0hYPZ/PcpVv5ju6RMAhgwZDDc=
 github.com/tchap/go-patricia/v2 v2.3.3/go.mod h1:VZRHKAb53DLaG+nA9EaYYiaEx6YztwDlLElMsnSHD4k=
+github.com/therootcompany/xz v1.0.1 h1:CmOtsn1CbtmyYiusbfmhmkpAAETj0wBIH6kCYaX+xzw=
+github.com/therootcompany/xz v1.0.1/go.mod h1:3K3UH1yCKgBneZYhuQUvJ9HPD19UEXEI0BWbMn8qNMY=
 github.com/tj/go-spin v1.1.0 h1:lhdWZsvImxvZ3q1C5OIB7d72DuOwP4O2NdBg9PyzNds=
 github.com/tj/go-spin v1.1.0/go.mod h1:Mg1mzmePZm4dva8Qz60H2lHwmJ2loum4VIrLgVnKwh4=
 github.com/tklauser/go-sysconf v0.3.15 h1:VE89k0criAymJ/Os65CSn1IXaol+1wrsFHEB8Ol49K4=
-- 
2.47.1

