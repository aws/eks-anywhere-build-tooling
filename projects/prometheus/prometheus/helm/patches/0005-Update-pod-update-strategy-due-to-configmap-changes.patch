From 816acce459e8fb4f7258fab754216d4558b5e6a3 Mon Sep 17 00:00:00 2001
From: Prow Bot <prow@amazonaws.com>
Date: Wed, 17 Dec 2025 21:57:26 -0800
Subject: [PATCH 5/6] Update pod update strategy due to configmap changes

---
 charts/prometheus/templates/deploy.yaml | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/charts/prometheus/templates/deploy.yaml b/charts/prometheus/templates/deploy.yaml
index 65951fda..77671cc1 100644
--- a/charts/prometheus/templates/deploy.yaml
+++ b/charts/prometheus/templates/deploy.yaml
@@ -65,10 +65,11 @@ spec:
   revisionHistoryLimit: {{ .Values.server.revisionHistoryLimit }}
   template:
     metadata:
-    {{- if .Values.server.podAnnotations }}
       annotations:
+        checksum/config: {{ include (print $.Template.BasePath "/cm.yaml") . | sha256sum }}
+      {{- if .Values.server.podAnnotations }}
         {{ toYaml .Values.server.podAnnotations | nindent 8 }}
-    {{- end }}
+      {{- end }}
       labels:
         {{- include "prometheus.server.labels" . | nindent 8 }}
         {{- if .Values.server.podLabels}}
-- 
2.50.1 (Apple Git-155)

