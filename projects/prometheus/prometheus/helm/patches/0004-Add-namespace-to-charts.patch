From 527d2b4838d03206894b7d93fc7c2cdd3b1cce8e Mon Sep 17 00:00:00 2001
From: Prow Bot <prow@amazonaws.com>
Date: Wed, 17 Dec 2025 21:57:05 -0800
Subject: [PATCH 4/6] Add namespace to charts

---
 charts/prometheus/templates/_helpers.tpl | 8 ++++++--
 charts/prometheus/values.yaml            | 2 ++
 2 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/charts/prometheus/templates/_helpers.tpl b/charts/prometheus/templates/_helpers.tpl
index fc0b0cbf..62e6bb0c 100644
--- a/charts/prometheus/templates/_helpers.tpl
+++ b/charts/prometheus/templates/_helpers.tpl
@@ -170,8 +170,12 @@ Create the name of the service account to use for the server component
 Define the prometheus.namespace template if set with forceNamespace or .Release.Namespace is set
 */}}
 {{- define "prometheus.namespace" -}}
-  {{- default .Release.Namespace .Values.forceNamespace -}}
-{{- end }}
+  {{- if .Values.forceNamespace -}}
+    {{- default .Values.forceNamespace .Values.defaultNamespace -}}
+  {{- else -}}
+    {{- default .Release.Namespace .Values.defaultNamespace -}}
+  {{- end -}}
+{{- end -}}
 
 {{/*
 Define template prometheus.namespaces producing a list of namespaces to monitor
diff --git a/charts/prometheus/values.yaml b/charts/prometheus/values.yaml
index b871026f..6e1f2248 100644
--- a/charts/prometheus/values.yaml
+++ b/charts/prometheus/values.yaml
@@ -9,6 +9,8 @@ rbac:
 podSecurityPolicy:
   enabled: false
 
+defaultNamespace: "observability"
+
 sourceRegistry: "783794618700.dkr.ecr.us-west-2.amazonaws.com"
 imagePullSecrets: []
 # - name: "image-pull-secret"
-- 
2.50.1 (Apple Git-155)

