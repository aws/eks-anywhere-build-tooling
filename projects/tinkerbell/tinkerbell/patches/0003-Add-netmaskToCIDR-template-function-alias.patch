From e3f8ef1fa17233167b6c254e11b02878301cc0d3 Mon Sep 17 00:00:00 2001
From: rajeshvenkata <rajesh.venkat.p@gmail.com>
Date: Wed, 28 Jan 2026 00:00:00 +0000
Subject: [PATCH 3/3] Add netmaskToCIDR template function alias

Adds netmaskToCIDR as an alias for netmaskToPrefixLength to maintain
backwards compatibility with existing EKS-A workflow templates that
use the netmaskToCIDR function name.

The function converts netmask notation (e.g., "255.255.255.0") to
CIDR prefix length (e.g., "24").

Signed-off-by: rajeshvenkata <rajesh.venkat.p@gmail.com>
---
 tink/controller/internal/workflow/template_funcs.go | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/tink/controller/internal/workflow/template_funcs.go b/tink/controller/internal/workflow/template_funcs.go
index a0074606..f3f09798 100644
--- a/tink/controller/internal/workflow/template_funcs.go
+++ b/tink/controller/internal/workflow/template_funcs.go
@@ -11,6 +11,8 @@ import (
 var templateFuncs = map[string]interface{}{
 	"formatPartition":       formatPartition,
 	"netmaskToPrefixLength": netmaskToPrefixLength,
+	// netmaskToCIDR is an alias for netmaskToPrefixLength for backwards compatibility
+	"netmaskToCIDR": netmaskToCIDR,
 }
 
 // formatPartition formats a device path with partition for the device type.
@@ -47,3 +49,13 @@ func netmaskToPrefixLength(netmask string) (string, error) {
 	ones, _ := net.IPMask(ipv4).Size()
 	return strconv.Itoa(ones), nil
 }
+
+// netmaskToCIDR is an alias for netmaskToPrefixLength that returns a default
+// value instead of an error for backwards compatibility with existing templates.
+func netmaskToCIDR(netmask string) string {
+	result, err := netmaskToPrefixLength(netmask)
+	if err != nil {
+		return "24" // Default to /24 if parsing fails
+	}
+	return result
+}
-- 
2.40.1