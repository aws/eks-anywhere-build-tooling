From 41851f8fc4a1d0682b7abeb030145deca0ce90f8 Mon Sep 17 00:00:00 2001
From: Abhinav Pandey <abhinavmpandey08@gmail.com>
Date: Thu, 2 Mar 2023 10:18:07 -0800
Subject: [PATCH 24/41] Add bottlerocket k8s settings support

Signed-off-by: Abhinav Pandey <abhinavmpandey08@gmail.com>
---
 api/v1beta1/zz_generated.openapi.go           |  18 +-
 .../kubeadm/api/v1beta1/kubeadm_types.go      |  30 +
 .../api/v1beta1/zz_generated.deepcopy.go      |  55 ++
 ...strap.cluster.x-k8s.io_kubeadmconfigs.yaml | 162 ++++++
 ...uster.x-k8s.io_kubeadmconfigtemplates.yaml | 168 ++++++
 .../internal/bottlerocket/bootstrap.go        |  21 +-
 .../internal/bottlerocket/bootstrap_test.go   | 534 ++++++++++++------
 .../internal/bottlerocket/bottlerocket.go     |  31 +-
 .../controllers/kubeadmconfig_controller.go   |   4 +-
 .../kubeadm/types/upstreamv1beta1/types.go    |  30 +
 .../upstreamv1beta1/zz_generated.deepcopy.go  |  55 ++
 .../zz_generated.conversion.go                |   2 +
 .../zz_generated.conversion.go                |   2 +
 ...cluster.x-k8s.io_kubeadmcontrolplanes.yaml | 162 ++++++
 ...x-k8s.io_kubeadmcontrolplanetemplates.yaml | 112 ++++
 .../webhooks/kubeadm_control_plane.go         |   2 +
 .../kubeadm/v1alpha4/kubeadm_types.go         |  30 +
 .../v1alpha4/zz_generated.conversion.go       |  68 +++
 .../kubeadm/v1alpha4/zz_generated.deepcopy.go |  55 ++
 19 files changed, 1356 insertions(+), 185 deletions(-)

diff --git a/api/v1beta1/zz_generated.openapi.go b/api/v1beta1/zz_generated.openapi.go
index 9ef21595b..0cf04fff4 100644
--- a/api/v1beta1/zz_generated.openapi.go
+++ b/api/v1beta1/zz_generated.openapi.go
@@ -555,6 +555,22 @@ func schema_sigsk8sio_cluster_api_api_v1beta1_ClusterClassStatus(ref common.Refe
 							Format:      "int64",
 						},
 					},
+					"managedExternalEtcdInitialized": {
+						SchemaProps: spec.SchemaProps{
+							Description: "ManagedExternalEtcdInitialized indicates that first etcd member's IP address is set by machine controller, so remaining etcd members can lookup the address to join the cluster",
+							Default:     false,
+							Type:        []string{"boolean"},
+							Format:      "",
+						},
+					},
+					"managedExternalEtcdReady": {
+						SchemaProps: spec.SchemaProps{
+							Description: "ManagedExternalEtcdReady indicates external etcd cluster is fully provisioned",
+							Default:     false,
+							Type:        []string{"boolean"},
+							Format:      "",
+						},
+					},
 					"v1beta2": {
 						SchemaProps: spec.SchemaProps{
 							Description: "v1beta2 groups all the fields that will be added or modified in ClusterClass's status with the V1Beta2 version.",
@@ -967,7 +983,7 @@ func schema_sigsk8sio_cluster_api_api_v1beta1_ClusterSpec(ref common.ReferenceCa
 							Description: "ManagedExternalEtcdRef is an optional reference to an etcd provider resource that holds details for provisioning an external etcd cluster",
 							Ref:         ref("k8s.io/api/core/v1.ObjectReference"),
 						},
-						},
+					},
 					"infrastructureRef": {
 						SchemaProps: spec.SchemaProps{
 							Description: "infrastructureRef is a reference to a provider-specific resource that holds the details for provisioning infrastructure for a cluster in said provider.",
diff --git a/bootstrap/kubeadm/api/v1beta1/kubeadm_types.go b/bootstrap/kubeadm/api/v1beta1/kubeadm_types.go
index 92d77c51f..77facbbf3 100644
--- a/bootstrap/kubeadm/api/v1beta1/kubeadm_types.go
+++ b/bootstrap/kubeadm/api/v1beta1/kubeadm_types.go
@@ -199,6 +199,31 @@ type ClusterConfiguration struct {
 	// This is only for bottlerocket.
 	// +optional
 	BottlerocketCustomBootstrapContainers []BottlerocketBootstrapContainer `json:"bottlerocketCustomBootstrapContainers,omitempty"`
+
+	// Bottlerocket holds configuration for certain bottlerocket settings.
+	// This is only for bottlerocket.
+	// +optional
+	Bottlerocket *BottlerocketSettings `json:"bottlerocket,omitempty"`
+}
+
+// BottlerocketSettings define bottlerocket settings that can be configured on bottlerocket nodes.
+// This setting is ONLY for bottlerocket nodes.
+type BottlerocketSettings struct {
+	// Kubernetes holds the kubernetes settings for bottlerocket nodes.
+	Kubernetes *BottlerocketKubernetesSettings `json:"kubernetes,omitempty"`
+}
+
+// BottlerocketKubernetesSettings holds the settings for kubernetes on bottlerocket nodes.
+// This setting is ONLY for bottlerocket nodes.
+type BottlerocketKubernetesSettings struct {
+	// MaxPods defines the maximum number of pods that can run on a node.
+	MaxPods int `json:"maxPods,omitempty"`
+
+	// AllowedUnsafeSysctls defines the list of unsafe sysctls that can be set on a node.
+	AllowedUnsafeSysctls []string `json:"allowedUnsafeSysctls,omitempty"`
+
+	// ClusterDNSIPs defines IP addresses of the DNS servers.
+	ClusterDNSIPs []string `json:"clusterDNSIPs,omitempty"`
 }
 
 // Pause defines the pause image repo and tag that should be run on the bootstrapped nodes.
@@ -671,6 +696,11 @@ type JoinConfiguration struct {
 	// This is only for bottlerocket.
 	// +optional
 	BottlerocketCustomBootstrapContainers []BottlerocketBootstrapContainer `json:"bottlerocketCustomBootstrapContainers,omitempty"`
+
+	// Bottlerocket holds configuration for certain bottlerocket settings.
+	// This is only for bottlerocket.
+	// +optional
+	Bottlerocket *BottlerocketSettings `json:"bottlerocket,omitempty"`
 }
 
 // BottlerocketHostContainer describes a host image for Bottlerocket
diff --git a/bootstrap/kubeadm/api/v1beta1/zz_generated.deepcopy.go b/bootstrap/kubeadm/api/v1beta1/zz_generated.deepcopy.go
index 4252e6c1e..b0c15071c 100644
--- a/bootstrap/kubeadm/api/v1beta1/zz_generated.deepcopy.go
+++ b/bootstrap/kubeadm/api/v1beta1/zz_generated.deepcopy.go
@@ -222,6 +222,51 @@ func (in *BottlerocketHostContainer) DeepCopy() *BottlerocketHostContainer {
 	return out
 }
 
+// DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
+func (in *BottlerocketKubernetesSettings) DeepCopyInto(out *BottlerocketKubernetesSettings) {
+	*out = *in
+	if in.AllowedUnsafeSysctls != nil {
+		in, out := &in.AllowedUnsafeSysctls, &out.AllowedUnsafeSysctls
+		*out = make([]string, len(*in))
+		copy(*out, *in)
+	}
+	if in.ClusterDNSIPs != nil {
+		in, out := &in.ClusterDNSIPs, &out.ClusterDNSIPs
+		*out = make([]string, len(*in))
+		copy(*out, *in)
+	}
+}
+
+// DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new BottlerocketKubernetesSettings.
+func (in *BottlerocketKubernetesSettings) DeepCopy() *BottlerocketKubernetesSettings {
+	if in == nil {
+		return nil
+	}
+	out := new(BottlerocketKubernetesSettings)
+	in.DeepCopyInto(out)
+	return out
+}
+
+// DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
+func (in *BottlerocketSettings) DeepCopyInto(out *BottlerocketSettings) {
+	*out = *in
+	if in.Kubernetes != nil {
+		in, out := &in.Kubernetes, &out.Kubernetes
+		*out = new(BottlerocketKubernetesSettings)
+		(*in).DeepCopyInto(*out)
+	}
+}
+
+// DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new BottlerocketSettings.
+func (in *BottlerocketSettings) DeepCopy() *BottlerocketSettings {
+	if in == nil {
+		return nil
+	}
+	out := new(BottlerocketSettings)
+	in.DeepCopyInto(out)
+	return out
+}
+
 // DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
 func (in *ClusterConfiguration) DeepCopyInto(out *ClusterConfiguration) {
 	*out = *in
@@ -255,6 +300,11 @@ func (in *ClusterConfiguration) DeepCopyInto(out *ClusterConfiguration) {
 		*out = make([]BottlerocketBootstrapContainer, len(*in))
 		copy(*out, *in)
 	}
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(BottlerocketSettings)
+		(*in).DeepCopyInto(*out)
+	}
 }
 
 // DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new ClusterConfiguration.
@@ -733,6 +783,11 @@ func (in *JoinConfiguration) DeepCopyInto(out *JoinConfiguration) {
 		*out = make([]BottlerocketBootstrapContainer, len(*in))
 		copy(*out, *in)
 	}
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(BottlerocketSettings)
+		(*in).DeepCopyInto(*out)
+	}
 }
 
 // DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new JoinConfiguration.
diff --git a/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigs.yaml b/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigs.yaml
index e40089a09..2ac525fe6 100644
--- a/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigs.yaml
+++ b/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigs.yaml
@@ -109,6 +109,33 @@ spec:
                       may reject unrecognized values.
                       More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                     type: string
+                  bottlerocket:
+                    description: |-
+                      Bottlerocket holds configuration for certain bottlerocket settings.
+                      This is only for bottlerocket.
+                    properties:
+                      kubernetes:
+                        description: Kubernetes holds the kubernetes settings for
+                          bottlerocket nodes.
+                        properties:
+                          allowedUnsafeSysctls:
+                            description: AllowedUnsafeSysctls defines the list of
+                              unsafe sysctls that can be set on a node.
+                            items:
+                              type: string
+                            type: array
+                          clusterDNSIPs:
+                            description: ClusterDNSIPs defines IP addresses of the
+                              DNS servers.
+                            items:
+                              type: string
+                            type: array
+                          maxPods:
+                            description: MaxPods defines the maximum number of pods
+                              that can run on a node.
+                            type: integer
+                        type: object
+                    type: object
                   bottlerocketAdmin:
                     description: |-
                       BottlerocketAdmin holds the image source for admin container
@@ -843,6 +870,33 @@ spec:
                       may reject unrecognized values.
                       More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                     type: string
+                  bottlerocket:
+                    description: |-
+                      Bottlerocket holds configuration for certain bottlerocket settings.
+                      This is only for bottlerocket.
+                    properties:
+                      kubernetes:
+                        description: Kubernetes holds the kubernetes settings for
+                          bottlerocket nodes.
+                        properties:
+                          allowedUnsafeSysctls:
+                            description: AllowedUnsafeSysctls defines the list of
+                              unsafe sysctls that can be set on a node.
+                            items:
+                              type: string
+                            type: array
+                          clusterDNSIPs:
+                            description: ClusterDNSIPs defines IP addresses of the
+                              DNS servers.
+                            items:
+                              type: string
+                            type: array
+                          maxPods:
+                            description: MaxPods defines the maximum number of pods
+                              that can run on a node.
+                            type: integer
+                        type: object
+                    type: object
                   bottlerocketAdmin:
                     description: |-
                       BottlerocketAdmin holds the image source for admin container
@@ -1461,6 +1515,33 @@ spec:
                       may reject unrecognized values.
                       More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                     type: string
+                  bottlerocket:
+                    description: |-
+                      Bottlerocket holds configuration for certain bottlerocket settings.
+                      This is only for bottlerocket.
+                    properties:
+                      kubernetes:
+                        description: Kubernetes holds the kubernetes settings for
+                          bottlerocket nodes.
+                        properties:
+                          allowedUnsafeSysctls:
+                            description: AllowedUnsafeSysctls defines the list of
+                              unsafe sysctls that can be set on a node.
+                            items:
+                              type: string
+                            type: array
+                          clusterDNSIPs:
+                            description: ClusterDNSIPs defines IP addresses of the
+                              DNS servers.
+                            items:
+                              type: string
+                            type: array
+                          maxPods:
+                            description: MaxPods defines the maximum number of pods
+                              that can run on a node.
+                            type: integer
+                        type: object
+                    type: object
                   bottlerocketAdmin:
                     description: |-
                       BottlerocketAdmin holds the image source for admin container
@@ -2191,6 +2272,33 @@ spec:
                       may reject unrecognized values.
                       More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                     type: string
+                  bottlerocket:
+                    description: |-
+                      Bottlerocket holds configuration for certain bottlerocket settings.
+                      This is only for bottlerocket.
+                    properties:
+                      kubernetes:
+                        description: Kubernetes holds the kubernetes settings for
+                          bottlerocket nodes.
+                        properties:
+                          allowedUnsafeSysctls:
+                            description: AllowedUnsafeSysctls defines the list of
+                              unsafe sysctls that can be set on a node.
+                            items:
+                              type: string
+                            type: array
+                          clusterDNSIPs:
+                            description: ClusterDNSIPs defines IP addresses of the
+                              DNS servers.
+                            items:
+                              type: string
+                            type: array
+                          maxPods:
+                            description: MaxPods defines the maximum number of pods
+                              that can run on a node.
+                            type: integer
+                        type: object
+                    type: object
                   bottlerocketAdmin:
                     description: |-
                       BottlerocketAdmin holds the image source for admin container
@@ -2949,6 +3057,33 @@ spec:
                       may reject unrecognized values.
                       More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                     type: string
+                  bottlerocket:
+                    description: |-
+                      Bottlerocket holds configuration for certain bottlerocket settings.
+                      This is only for bottlerocket.
+                    properties:
+                      kubernetes:
+                        description: Kubernetes holds the kubernetes settings for
+                          bottlerocket nodes.
+                        properties:
+                          allowedUnsafeSysctls:
+                            description: AllowedUnsafeSysctls defines the list of
+                              unsafe sysctls that can be set on a node.
+                            items:
+                              type: string
+                            type: array
+                          clusterDNSIPs:
+                            description: ClusterDNSIPs defines IP addresses of the
+                              DNS servers.
+                            items:
+                              type: string
+                            type: array
+                          maxPods:
+                            description: MaxPods defines the maximum number of pods
+                              that can run on a node.
+                            type: integer
+                        type: object
+                    type: object
                   bottlerocketAdmin:
                     description: |-
                       BottlerocketAdmin holds the image source for admin container
@@ -4284,6 +4419,33 @@ spec:
                       may reject unrecognized values.
                       More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                     type: string
+                  bottlerocket:
+                    description: |-
+                      Bottlerocket holds configuration for certain bottlerocket settings.
+                      This is only for bottlerocket.
+                    properties:
+                      kubernetes:
+                        description: Kubernetes holds the kubernetes settings for
+                          bottlerocket nodes.
+                        properties:
+                          allowedUnsafeSysctls:
+                            description: AllowedUnsafeSysctls defines the list of
+                              unsafe sysctls that can be set on a node.
+                            items:
+                              type: string
+                            type: array
+                          clusterDNSIPs:
+                            description: ClusterDNSIPs defines IP addresses of the
+                              DNS servers.
+                            items:
+                              type: string
+                            type: array
+                          maxPods:
+                            description: MaxPods defines the maximum number of pods
+                              that can run on a node.
+                            type: integer
+                        type: object
+                    type: object
                   bottlerocketAdmin:
                     description: |-
                       BottlerocketAdmin holds the image source for admin container
diff --git a/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigtemplates.yaml b/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigtemplates.yaml
index 4841e4685..d3c98c802 100644
--- a/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigtemplates.yaml
+++ b/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigtemplates.yaml
@@ -117,6 +117,34 @@ spec:
                               may reject unrecognized values.
                               More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                             type: string
+                          bottlerocket:
+                            description: |-
+                              Bottlerocket holds configuration for certain bottlerocket settings.
+                              This is only for bottlerocket.
+                            properties:
+                              kubernetes:
+                                description: Kubernetes holds the kubernetes settings
+                                  for bottlerocket nodes.
+                                properties:
+                                  allowedUnsafeSysctls:
+                                    description: AllowedUnsafeSysctls defines the
+                                      list of unsafe sysctls that can be set on a
+                                      node.
+                                    items:
+                                      type: string
+                                    type: array
+                                  clusterDNSIPs:
+                                    description: ClusterDNSIPs defines IP addresses
+                                      of the DNS servers.
+                                    items:
+                                      type: string
+                                    type: array
+                                  maxPods:
+                                    description: MaxPods defines the maximum number
+                                      of pods that can run on a node.
+                                    type: integer
+                                type: object
+                            type: object
                           bottlerocketAdmin:
                             description: |-
                               BottlerocketAdmin holds the image source for admin container
@@ -866,6 +894,34 @@ spec:
                               may reject unrecognized values.
                               More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                             type: string
+                          bottlerocket:
+                            description: |-
+                              Bottlerocket holds configuration for certain bottlerocket settings.
+                              This is only for bottlerocket.
+                            properties:
+                              kubernetes:
+                                description: Kubernetes holds the kubernetes settings
+                                  for bottlerocket nodes.
+                                properties:
+                                  allowedUnsafeSysctls:
+                                    description: AllowedUnsafeSysctls defines the
+                                      list of unsafe sysctls that can be set on a
+                                      node.
+                                    items:
+                                      type: string
+                                    type: array
+                                  clusterDNSIPs:
+                                    description: ClusterDNSIPs defines IP addresses
+                                      of the DNS servers.
+                                    items:
+                                      type: string
+                                    type: array
+                                  maxPods:
+                                    description: MaxPods defines the maximum number
+                                      of pods that can run on a node.
+                                    type: integer
+                                type: object
+                            type: object
                           bottlerocketAdmin:
                             description: |-
                               BottlerocketAdmin holds the image source for admin container
@@ -1430,6 +1486,34 @@ spec:
                               may reject unrecognized values.
                               More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                             type: string
+                          bottlerocket:
+                            description: |-
+                              Bottlerocket holds configuration for certain bottlerocket settings.
+                              This is only for bottlerocket.
+                            properties:
+                              kubernetes:
+                                description: Kubernetes holds the kubernetes settings
+                                  for bottlerocket nodes.
+                                properties:
+                                  allowedUnsafeSysctls:
+                                    description: AllowedUnsafeSysctls defines the
+                                      list of unsafe sysctls that can be set on a
+                                      node.
+                                    items:
+                                      type: string
+                                    type: array
+                                  clusterDNSIPs:
+                                    description: ClusterDNSIPs defines IP addresses
+                                      of the DNS servers.
+                                    items:
+                                      type: string
+                                    type: array
+                                  maxPods:
+                                    description: MaxPods defines the maximum number
+                                      of pods that can run on a node.
+                                    type: integer
+                                type: object
+                            type: object
                           bottlerocketAdmin:
                             description: |-
                               BottlerocketAdmin holds the image source for admin container
@@ -2176,6 +2260,34 @@ spec:
                               may reject unrecognized values.
                               More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                             type: string
+                          bottlerocket:
+                            description: |-
+                              Bottlerocket holds configuration for certain bottlerocket settings.
+                              This is only for bottlerocket.
+                            properties:
+                              kubernetes:
+                                description: Kubernetes holds the kubernetes settings
+                                  for bottlerocket nodes.
+                                properties:
+                                  allowedUnsafeSysctls:
+                                    description: AllowedUnsafeSysctls defines the
+                                      list of unsafe sysctls that can be set on a
+                                      node.
+                                    items:
+                                      type: string
+                                    type: array
+                                  clusterDNSIPs:
+                                    description: ClusterDNSIPs defines IP addresses
+                                      of the DNS servers.
+                                    items:
+                                      type: string
+                                    type: array
+                                  maxPods:
+                                    description: MaxPods defines the maximum number
+                                      of pods that can run on a node.
+                                    type: integer
+                                type: object
+                            type: object
                           bottlerocketAdmin:
                             description: |-
                               BottlerocketAdmin holds the image source for admin container
@@ -2914,6 +3026,34 @@ spec:
                               may reject unrecognized values.
                               More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                             type: string
+                          bottlerocket:
+                            description: |-
+                              Bottlerocket holds configuration for certain bottlerocket settings.
+                              This is only for bottlerocket.
+                            properties:
+                              kubernetes:
+                                description: Kubernetes holds the kubernetes settings
+                                  for bottlerocket nodes.
+                                properties:
+                                  allowedUnsafeSysctls:
+                                    description: AllowedUnsafeSysctls defines the
+                                      list of unsafe sysctls that can be set on a
+                                      node.
+                                    items:
+                                      type: string
+                                    type: array
+                                  clusterDNSIPs:
+                                    description: ClusterDNSIPs defines IP addresses
+                                      of the DNS servers.
+                                    items:
+                                      type: string
+                                    type: array
+                                  maxPods:
+                                    description: MaxPods defines the maximum number
+                                      of pods that can run on a node.
+                                    type: integer
+                                type: object
+                            type: object
                           bottlerocketAdmin:
                             description: |-
                               BottlerocketAdmin holds the image source for admin container
@@ -4282,6 +4422,34 @@ spec:
                               may reject unrecognized values.
                               More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                             type: string
+                          bottlerocket:
+                            description: |-
+                              Bottlerocket holds configuration for certain bottlerocket settings.
+                              This is only for bottlerocket.
+                            properties:
+                              kubernetes:
+                                description: Kubernetes holds the kubernetes settings
+                                  for bottlerocket nodes.
+                                properties:
+                                  allowedUnsafeSysctls:
+                                    description: AllowedUnsafeSysctls defines the
+                                      list of unsafe sysctls that can be set on a
+                                      node.
+                                    items:
+                                      type: string
+                                    type: array
+                                  clusterDNSIPs:
+                                    description: ClusterDNSIPs defines IP addresses
+                                      of the DNS servers.
+                                    items:
+                                      type: string
+                                    type: array
+                                  maxPods:
+                                    description: MaxPods defines the maximum number
+                                      of pods that can run on a node.
+                                    type: integer
+                                type: object
+                            type: object
                           bottlerocketAdmin:
                             description: |-
                               BottlerocketAdmin holds the image source for admin container
diff --git a/bootstrap/kubeadm/internal/bottlerocket/bootstrap.go b/bootstrap/kubeadm/internal/bottlerocket/bootstrap.go
index 9cf4a909a..e5926de86 100644
--- a/bootstrap/kubeadm/internal/bottlerocket/bootstrap.go
+++ b/bootstrap/kubeadm/internal/bottlerocket/bootstrap.go
@@ -10,8 +10,17 @@ standalone-mode = true
 authentication-mode = "tls"
 server-tls-bootstrap = false
 pod-infra-container-image = "{{.PauseContainerSource}}"
-{{- if (ne .ProviderId "")}}
-provider-id = "{{.ProviderId}}"
+{{- if (ne .ProviderID "")}}
+provider-id = "{{.ProviderID}}"
+{{- end -}}
+{{- if .AllowedUnsafeSysctls }}
+allowed-unsafe-sysctls = [{{stringsJoin .AllowedUnsafeSysctls ", " }}]
+{{- end -}}
+{{- if .ClusterDNSIPs }}
+cluster-dns-ip = [{{stringsJoin .ClusterDNSIPs ", " }}]
+{{- end -}}
+{{- if .MaxPods }}
+max-pods = {{.MaxPods}}
 {{- end -}}
 {{- end -}}
 `
@@ -20,8 +29,8 @@ provider-id = "{{.ProviderId}}"
 [settings.host-containers.{{.Name}}]
 enabled = true
 superpowered = {{.Superpowered}}
-{{- if (ne (imageUrl .ImageMeta) "")}}
-source = "{{imageUrl .ImageMeta}}"
+{{- if (ne (imageURL .ImageMeta) "")}}
+source = "{{imageURL .ImageMeta}}"
 {{- end -}}
 {{- if (ne .UserData "")}}
 user-data = "{{.UserData}}"
@@ -40,8 +49,8 @@ user-data = "{{.UserData}}"
 [settings.bootstrap-containers.{{.Name}}]
 essential = {{.Essential}}
 mode = "{{.Mode}}"
-{{- if (ne (imageUrl .ImageMeta) "")}}
-source = "{{imageUrl .ImageMeta}}"
+{{- if (ne (imageURL .ImageMeta) "")}}
+source = "{{imageURL .ImageMeta}}"
 {{- end -}}
 {{- if (ne .UserData "")}}
 user-data = "{{.UserData}}"
diff --git a/bootstrap/kubeadm/internal/bottlerocket/bootstrap_test.go b/bootstrap/kubeadm/internal/bottlerocket/bootstrap_test.go
index dd0422007..3463a2769 100644
--- a/bootstrap/kubeadm/internal/bottlerocket/bootstrap_test.go
+++ b/bootstrap/kubeadm/internal/bottlerocket/bootstrap_test.go
@@ -4,273 +4,471 @@ import (
 	"testing"
 
 	. "github.com/onsi/gomega"
+	corev1 "k8s.io/api/core/v1"
 
 	bootstrapv1 "sigs.k8s.io/cluster-api/bootstrap/kubeadm/api/v1beta1"
 )
 
-const userDataFullSetting = `
+const (
+	minimalUserData = `
 [settings.host-containers.admin]
 enabled = true
 superpowered = true
-source = "REPO:TAG"
-user-data = "B64USERDATA"
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
 [settings.host-containers.kubeadm-bootstrap]
 enabled = true
 superpowered = true
-source = "REPO:TAG"
-user-data = "B64USERDATA"
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
 
 [settings.kubernetes]
 cluster-domain = "cluster.local"
 standalone-mode = true
 authentication-mode = "tls"
 server-tls-bootstrap = false
-pod-infra-container-image = "PAUSE"
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
 provider-id = "PROVIDERID"
 
 [settings.network]
-hostname = ""
-https-proxy = "PROXY"
-no-proxy = []
+hostname = "hostname"`
 
-[settings.bootstrap-containers.BOOTSTRAP]
-essential = false
-mode = "MODE"
-user-data = "B64USERDATA"
+	nodeLabelslUserData = `
+[settings.host-containers.admin]
+enabled = true
+superpowered = true
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
+[settings.host-containers.kubeadm-bootstrap]
+enabled = true
+superpowered = true
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
+
+[settings.kubernetes]
+cluster-domain = "cluster.local"
+standalone-mode = true
+authentication-mode = "tls"
+server-tls-bootstrap = false
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
+provider-id = "PROVIDERID"
+
+[settings.network]
+hostname = "hostname"
+[settings.kubernetes.node-labels]
+"KEY1" = "VAL1"
+"KEY2" = "VAL2"
+"KEY3" = "VAL3"
+`
+
+	taintsUserData = `
+[settings.host-containers.admin]
+enabled = true
+superpowered = true
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
+[settings.host-containers.kubeadm-bootstrap]
+enabled = true
+superpowered = true
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
+
+[settings.kubernetes]
+cluster-domain = "cluster.local"
+standalone-mode = true
+authentication-mode = "tls"
+server-tls-bootstrap = false
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
+provider-id = "PROVIDERID"
+
+[settings.network]
+hostname = "hostname"
+[settings.kubernetes.node-taints]
+"KEY1" = ["VAL1:NoSchedule"]
+`
+
+	proxyUserData = `
+[settings.host-containers.admin]
+enabled = true
+superpowered = true
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
+[settings.host-containers.kubeadm-bootstrap]
+enabled = true
+superpowered = true
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
+
+[settings.kubernetes]
+cluster-domain = "cluster.local"
+standalone-mode = true
+authentication-mode = "tls"
+server-tls-bootstrap = false
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
+provider-id = "PROVIDERID"
+
+[settings.network]
+hostname = "hostname"
+https-proxy = "HTTPS_PROXY"
+no-proxy = ["no_proxy1","no_proxy2","no_proxy3"]`
+
+	registryMirrorUserData = `
+[settings.host-containers.admin]
+enabled = true
+superpowered = true
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
+[settings.host-containers.kubeadm-bootstrap]
+enabled = true
+superpowered = true
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
+
+[settings.kubernetes]
+cluster-domain = "cluster.local"
+standalone-mode = true
+authentication-mode = "tls"
+server-tls-bootstrap = false
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
+provider-id = "PROVIDERID"
+
+[settings.network]
+hostname = "hostname"
 [settings.container-registry.mirrors]
-"public.ecr.aws" = ["https://REGISTRYENDPOINT"]
+"public.ecr.aws" = ["https://REGISTRY_ENDPOINT"]
 [settings.pki.registry-mirror-ca]
-data = "REGISTRYCA"
+data = "UkVHSVNUUllfQ0E="
+trusted=true`
+
+	registryMirrorAndAuthUserData = `
+[settings.host-containers.admin]
+enabled = true
+superpowered = true
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
+[settings.host-containers.kubeadm-bootstrap]
+enabled = true
+superpowered = true
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
+
+[settings.kubernetes]
+cluster-domain = "cluster.local"
+standalone-mode = true
+authentication-mode = "tls"
+server-tls-bootstrap = false
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
+provider-id = "PROVIDERID"
+
+[settings.network]
+hostname = "hostname"
+[settings.container-registry.mirrors]
+"public.ecr.aws" = ["https://REGISTRY_ENDPOINT"]
+[settings.pki.registry-mirror-ca]
+data = "UkVHSVNUUllfQ0E="
 trusted=true
 [[settings.container-registry.credentials]]
 registry = "public.ecr.aws"
 username = "admin"
 password = "pass"
 [[settings.container-registry.credentials]]
-registry = "REGISTRYENDPOINT"
+registry = "REGISTRY_ENDPOINT"
 username = "admin"
-password = "pass"
-[settings.kubernetes.node-labels]
-KEY=VAR
-[settings.kubernetes.node-taints]
-KEY=VAR
+password = "pass"`
+
+	ntpUserData = `
+[settings.host-containers.admin]
+enabled = true
+superpowered = true
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
+[settings.host-containers.kubeadm-bootstrap]
+enabled = true
+superpowered = true
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
+
+[settings.kubernetes]
+cluster-domain = "cluster.local"
+standalone-mode = true
+authentication-mode = "tls"
+server-tls-bootstrap = false
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
+provider-id = "PROVIDERID"
+
+[settings.network]
+hostname = "hostname"
 [settings.ntp]
 time-servers = ["1.2.3.4", "time-a.capi.com", "time-b.capi.com"]`
 
-const userDataNoAdminImage = `
+	kubernetesSettingsUserData = `
 [settings.host-containers.admin]
 enabled = true
 superpowered = true
-user-data = "B64USERDATA"
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
 [settings.host-containers.kubeadm-bootstrap]
 enabled = true
 superpowered = true
-source = "REPO:TAG"
-user-data = "B64USERDATA"
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
 
 [settings.kubernetes]
 cluster-domain = "cluster.local"
 standalone-mode = true
 authentication-mode = "tls"
 server-tls-bootstrap = false
-pod-infra-container-image = "PAUSE"
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
 provider-id = "PROVIDERID"
+allowed-unsafe-sysctls = ["net.core.somaxconn", "net.ipv4.ip_local_port_range"]
+cluster-dns-ip = ["1.2.3.4", "4.3.2.1"]
+max-pods = 100
 
 [settings.network]
-hostname = ""
-https-proxy = "PROXY"
-no-proxy = []
-
-[settings.bootstrap-containers.BOOTSTRAP]
-essential = false
-mode = "MODE"
-user-data = "B64USERDATA"
-[settings.container-registry.mirrors]
-"public.ecr.aws" = ["https://REGISTRYENDPOINT"]
-[settings.pki.registry-mirror-ca]
-data = "REGISTRYCA"
-trusted=true
-[settings.kubernetes.node-labels]
-KEY=VAR
-[settings.kubernetes.node-taints]
-KEY=VAR`
+hostname = "hostname"`
 
-const userDataWithHostname = `
+	customBootstrapUserData = `
 [settings.host-containers.admin]
 enabled = true
 superpowered = true
-source = "REPO:TAG"
-user-data = "B64USERDATA"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
 [settings.host-containers.kubeadm-bootstrap]
 enabled = true
 superpowered = true
-source = "REPO:TAG"
-user-data = "B64USERDATA"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
 
 [settings.kubernetes]
 cluster-domain = "cluster.local"
 standalone-mode = true
 authentication-mode = "tls"
 server-tls-bootstrap = false
-pod-infra-container-image = "PAUSE"
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
 provider-id = "PROVIDERID"
 
 [settings.network]
 hostname = "hostname"
-https-proxy = "PROXY"
-no-proxy = []
 
 [settings.bootstrap-containers.BOOTSTRAP]
 essential = false
 mode = "MODE"
-user-data = "B64USERDATA"
-[settings.container-registry.mirrors]
-"public.ecr.aws" = ["https://REGISTRYENDPOINT"]
-[settings.pki.registry-mirror-ca]
-data = "REGISTRYCA"
-trusted=true
-[settings.kubernetes.node-labels]
-KEY=VAR
-[settings.kubernetes.node-taints]
-KEY=VAR`
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "BOOTSTRAP_B6_4USERDATA"`
+)
+
+var (
+	brAdmin = bootstrapv1.BottlerocketAdmin{
+		ImageMeta: bootstrapv1.ImageMeta{
+			ImageRepository: "ADMIN_REPO",
+			ImageTag:        "ADMIN_TAG",
+		},
+	}
+
+	brBootstrap = bootstrapv1.BottlerocketBootstrap{
+		ImageMeta: bootstrapv1.ImageMeta{
+			ImageRepository: "BOOTSTRAP_REPO",
+			ImageTag:        "BOOTSTRAP_TAG",
+		},
+	}
+
+	users = []bootstrapv1.User{
+		{
+			Name:              "ec2-user",
+			SSHAuthorizedKeys: []string{"ssh-rsa AAA..."},
+		},
+	}
+
+	bootstrapContainers = []bootstrapv1.BottlerocketBootstrapContainer{
+		{
+			Name: "BOOTSTRAP",
+			Mode: "MODE",
+			ImageMeta: bootstrapv1.ImageMeta{
+				ImageRepository: "BOOTSTRAP_REPO",
+				ImageTag:        "BOOTSTRAP_TAG",
+			},
+			UserData: "BOOTSTRAP_B6_4USERDATA",
+		},
+	}
+
+	pause = bootstrapv1.Pause{
+		ImageMeta: bootstrapv1.ImageMeta{
+			ImageRepository: "PAUSE_REPO",
+			ImageTag:        "PAUSE_TAG",
+		},
+	}
+)
 
-func TestGenerateUserData(t *testing.T) {
+func TestGetBottlerocketNodeUserData(t *testing.T) {
 	g := NewWithT(t)
+	hostname := "hostname"
+	brBootstrapUserdata := []byte("BOTTLEROCKET_BOOTSTRAP_USERDATA")
 
 	testcases := []struct {
 		name   string
-		input  *BottlerocketSettingsInput
+		config *BottlerocketConfig
 		output string
 	}{
 		{
-			name: "full settings",
-			input: &BottlerocketSettingsInput{
-				PauseContainerSource:   "PAUSE",
-				HTTPSProxyEndpoint:     "PROXY",
-				RegistryMirrorEndpoint: "REGISTRYENDPOINT",
-				RegistryMirrorCACert:   "REGISTRYCA",
-				NodeLabels:             "KEY=VAR",
-				Taints:                 "KEY=VAR",
-				ProviderId:             "PROVIDERID",
-				RegistryMirrorUsername: "admin",
-				RegistryMirrorPassword: "pass",
-				NTPServers: []string{
-					"\"1.2.3.4\"",
-					"\"time-a.capi.com\"",
-					"\"time-b.capi.com\"",
+			name: "minimal settings",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
 				},
-				HostContainers: []bootstrapv1.BottlerocketHostContainer{
-					{
-						Name:         "admin",
-						Superpowered: true,
-						ImageMeta: bootstrapv1.ImageMeta{
-							ImageRepository: "REPO",
-							ImageTag:        "TAG",
-						},
-						UserData: "B64USERDATA",
-					},
-					{
-						Name:         "kubeadm-bootstrap",
-						Superpowered: true,
-						ImageMeta: bootstrapv1.ImageMeta{
-							ImageRepository: "REPO",
-							ImageTag:        "TAG",
-						},
-						UserData: "B64USERDATA",
-					},
+			},
+			output: minimalUserData,
+		},
+		{
+			name: "with node labels",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"node-labels": "KEY1=VAL1,KEY2=VAL2,KEY3=VAL3",
+					"provider-id": "PROVIDERID",
+				},
+			},
+			output: nodeLabelslUserData,
+		},
+		{
+			name: "with taints",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
 				},
-				BootstrapContainers: []bootstrapv1.BottlerocketBootstrapContainer{
+				Taints: []corev1.Taint{
 					{
-						Name:     "BOOTSTRAP",
-						Mode:     "MODE",
-						UserData: "B64USERDATA",
+						Key:    "KEY1",
+						Value:  "VAL1",
+						Effect: corev1.TaintEffectNoSchedule,
 					},
 				},
 			},
-			output: userDataFullSetting,
+			output: taintsUserData,
 		},
 		{
-			name: "no admin image meta",
-			input: &BottlerocketSettingsInput{
-				PauseContainerSource:   "PAUSE",
-				HTTPSProxyEndpoint:     "PROXY",
-				RegistryMirrorEndpoint: "REGISTRYENDPOINT",
-				RegistryMirrorCACert:   "REGISTRYCA",
-				NodeLabels:             "KEY=VAR",
-				Taints:                 "KEY=VAR",
-				ProviderId:             "PROVIDERID",
-				HostContainers: []bootstrapv1.BottlerocketHostContainer{
-					{
-						Name:         "admin",
-						Superpowered: true,
-						ImageMeta:    bootstrapv1.ImageMeta{},
-						UserData:     "B64USERDATA",
-					},
-					{
-						Name:         "kubeadm-bootstrap",
-						Superpowered: true,
-						ImageMeta: bootstrapv1.ImageMeta{
-							ImageRepository: "REPO",
-							ImageTag:        "TAG",
-						},
-						UserData: "B64USERDATA",
-					},
+			name: "with proxy",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
 				},
-				BootstrapContainers: []bootstrapv1.BottlerocketBootstrapContainer{
-					{
-						Name:     "BOOTSTRAP",
-						Mode:     "MODE",
-						UserData: "B64USERDATA",
-					},
+				ProxyConfiguration: bootstrapv1.ProxyConfiguration{
+					HTTPSProxy: "HTTPS_PROXY",
+					NoProxy:    []string{"no_proxy1", "no_proxy2", "no_proxy3"},
 				},
 			},
-			output: userDataNoAdminImage,
+			output: proxyUserData,
 		},
 		{
-			name: "with hostname settings",
-			input: &BottlerocketSettingsInput{
-				PauseContainerSource:   "PAUSE",
-				HTTPSProxyEndpoint:     "PROXY",
-				RegistryMirrorEndpoint: "REGISTRYENDPOINT",
-				RegistryMirrorCACert:   "REGISTRYCA",
-				NodeLabels:             "KEY=VAR",
-				Taints:                 "KEY=VAR",
-				ProviderId:             "PROVIDERID",
-				Hostname:               "hostname",
-				HostContainers: []bootstrapv1.BottlerocketHostContainer{
-					{
-						Name:         "admin",
-						Superpowered: true,
-						ImageMeta: bootstrapv1.ImageMeta{
-							ImageRepository: "REPO",
-							ImageTag:        "TAG",
+			name: "with registry mirror",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
+				},
+				RegistryMirrorConfiguration: bootstrapv1.RegistryMirrorConfiguration{
+					Endpoint: "REGISTRY_ENDPOINT",
+					CACert:   "REGISTRY_CA",
+				},
+			},
+			output: registryMirrorUserData,
+		},
+		{
+			name: "with registry mirror and auth",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
+				},
+				RegistryMirrorConfiguration: bootstrapv1.RegistryMirrorConfiguration{
+					Endpoint: "REGISTRY_ENDPOINT",
+					CACert:   "REGISTRY_CA",
+				},
+				RegistryMirrorCredentials: RegistryMirrorCredentials{
+					Username: "admin",
+					Password: "pass",
+				},
+			},
+			output: registryMirrorAndAuthUserData,
+		},
+		{
+			name: "with ntp servers",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
+				},
+				NTPServers: []string{
+					"1.2.3.4",
+					"time-a.capi.com",
+					"time-b.capi.com",
+				},
+			},
+			output: ntpUserData,
+		},
+		{
+			name: "with kubernetes settings",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
+				},
+				BottlerocketSettings: &bootstrapv1.BottlerocketSettings{
+					Kubernetes: &bootstrapv1.BottlerocketKubernetesSettings{
+						MaxPods: 100,
+						ClusterDNSIPs: []string{
+							"1.2.3.4",
+							"4.3.2.1",
 						},
-						UserData: "B64USERDATA",
-					},
-					{
-						Name:         "kubeadm-bootstrap",
-						Superpowered: true,
-						ImageMeta: bootstrapv1.ImageMeta{
-							ImageRepository: "REPO",
-							ImageTag:        "TAG",
+						AllowedUnsafeSysctls: []string{
+							"net.core.somaxconn",
+							"net.ipv4.ip_local_port_range",
 						},
-						UserData: "B64USERDATA",
 					},
 				},
-				BootstrapContainers: []bootstrapv1.BottlerocketBootstrapContainer{
-					{
-						Name:     "BOOTSTRAP",
-						Mode:     "MODE",
-						UserData: "B64USERDATA",
-					},
+			},
+			output: kubernetesSettingsUserData,
+		},
+		{
+			name: "with custom bootstrap containers",
+			config: &BottlerocketConfig{
+				Pause: pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
 				},
+				BottlerocketCustomBootstrapContainers: bootstrapContainers,
+				Hostname:                              hostname,
 			},
-			output: userDataWithHostname,
+			output: customBootstrapUserData,
 		},
 	}
 	for _, testcase := range testcases {
 		t.Run(testcase.name, func(t *testing.T) {
-			b, err := generateNodeUserData("TestBottlerocketInit", bottlerocketNodeInitSettingsTemplate, testcase.input)
+			b, err := getBottlerocketNodeUserData(brBootstrapUserdata, users, testcase.config)
 			g.Expect(err).NotTo(HaveOccurred())
 			g.Expect(string(b)).To(Equal(testcase.output))
 		})
diff --git a/bootstrap/kubeadm/internal/bottlerocket/bottlerocket.go b/bootstrap/kubeadm/internal/bottlerocket/bottlerocket.go
index 658f3a05e..cbab7c7a4 100644
--- a/bootstrap/kubeadm/internal/bottlerocket/bottlerocket.go
+++ b/bootstrap/kubeadm/internal/bottlerocket/bottlerocket.go
@@ -22,11 +22,13 @@ const (
 `
 )
 
+// BottlerocketConfig is the Bottlerocket configuration for a machine.
 type BottlerocketConfig struct {
 	Pause                                 bootstrapv1.Pause
 	BottlerocketBootstrap                 bootstrapv1.BottlerocketBootstrap
 	BottlerocketAdmin                     bootstrapv1.BottlerocketAdmin
 	BottlerocketControl                   bootstrapv1.BottlerocketControl
+	BottlerocketSettings                  *bootstrapv1.BottlerocketSettings
 	ProxyConfiguration                    bootstrapv1.ProxyConfiguration
 	RegistryMirrorConfiguration           bootstrapv1.RegistryMirrorConfiguration
 	KubeletExtraArgs                      map[string]string
@@ -38,6 +40,7 @@ type BottlerocketConfig struct {
 	RegistryMirrorCredentials
 }
 
+// BottlerocketSettingsInput is the input for the Bottlerocket settings template.
 type BottlerocketSettingsInput struct {
 	PauseContainerSource   string
 	HTTPSProxyEndpoint     string
@@ -49,17 +52,22 @@ type BottlerocketSettingsInput struct {
 	NodeLabels             string
 	NTPServers             []string
 	Taints                 string
-	ProviderId             string
+	ProviderID             string
 	Hostname               string
+	AllowedUnsafeSysctls   []string
+	ClusterDNSIPs           []string
+	MaxPods                int
 	HostContainers         []bootstrapv1.BottlerocketHostContainer
 	BootstrapContainers    []bootstrapv1.BottlerocketBootstrapContainer
 }
 
+// HostPath holds the path and type of a host path volume.
 type HostPath struct {
 	Path string
 	Type string
 }
 
+// RegistryMirrorCredentials holds registry mirror credentials to be configured on bottlerocket nodes.
 type RegistryMirrorCredentials struct {
 	Username string
 	Password string
@@ -100,7 +108,7 @@ func generateAdminContainerUserData(kind string, tpl string, data interface{}) (
 	return out.Bytes(), nil
 }
 
-func imageUrl(containerLocation bootstrapv1.ImageMeta) string {
+func imageURL(containerLocation bootstrapv1.ImageMeta) string {
 	if containerLocation.ImageRepository != "" && containerLocation.ImageTag != "" {
 		return fmt.Sprintf("%s:%s", containerLocation.ImageRepository, containerLocation.ImageTag)
 	}
@@ -110,7 +118,7 @@ func imageUrl(containerLocation bootstrapv1.ImageMeta) string {
 func generateNodeUserData(kind string, tpl string, data interface{}) ([]byte, error) {
 	tm := template.New(kind).Funcs(template.FuncMap{
 		"stringsJoin": strings.Join,
-		"imageUrl":    imageUrl,
+		"imageURL":    imageURL,
 	})
 	if _, err := tm.Parse(hostContainerTemplate); err != nil {
 		return nil, errors.Wrapf(err, "failed to parse hostContainerSettings %s template", kind)
@@ -208,7 +216,7 @@ func getBottlerocketNodeUserData(bootstrapContainerUserData []byte, users []boot
 		RegistryMirrorEndpoint: config.RegistryMirrorConfiguration.Endpoint,
 		NodeLabels:             parseNodeLabels(config.KubeletExtraArgs["node-labels"]), // empty string if it does not exist
 		Taints:                 parseTaints(config.Taints),                              // empty string if it does not exist
-		ProviderId:             config.KubeletExtraArgs["provider-id"],
+		ProviderID:             config.KubeletExtraArgs["provider-id"],
 		Hostname:               config.Hostname,
 		HostContainers:         hostContainers,
 		BootstrapContainers:    config.BottlerocketCustomBootstrapContainers,
@@ -231,12 +239,17 @@ func getBottlerocketNodeUserData(bootstrapContainerUserData []byte, users []boot
 			bottlerocketInput.NTPServers = append(bottlerocketInput.NTPServers, strconv.Quote(ntp))
 		}
 	}
-
-	bottlerocketNodeUserData, err := generateNodeUserData("InitBottlerocketNode", bottlerocketNodeInitSettingsTemplate, bottlerocketInput)
-	if err != nil {
-		return nil, err
+	if config.BottlerocketSettings != nil && config.BottlerocketSettings.Kubernetes != nil {
+		bottlerocketInput.MaxPods = config.BottlerocketSettings.Kubernetes.MaxPods
+		for _, sysctl := range config.BottlerocketSettings.Kubernetes.AllowedUnsafeSysctls {
+			bottlerocketInput.AllowedUnsafeSysctls = append(bottlerocketInput.AllowedUnsafeSysctls, strconv.Quote(sysctl))
+		}
+		for _, ip := range config.BottlerocketSettings.Kubernetes.ClusterDNSIPs {
+			bottlerocketInput.ClusterDNSIPs = append(bottlerocketInput.ClusterDNSIPs, strconv.Quote(ip))
+		}
 	}
-	return bottlerocketNodeUserData, nil
+
+	return generateNodeUserData("InitBottlerocketNode", bottlerocketNodeInitSettingsTemplate, bottlerocketInput)
 }
 
 // bottlerocket configuration accepts taints in the format
diff --git a/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go b/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go
index ac1659171..1e88c2d7c 100644
--- a/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go
+++ b/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go
@@ -591,6 +591,7 @@ func (r *KubeadmConfigReconciler) handleClusterNotInitialized(ctx context.Contex
 			BottlerocketControl:                   scope.Config.Spec.ClusterConfiguration.BottlerocketControl,
 			BottlerocketCustomHostContainers:      scope.Config.Spec.ClusterConfiguration.BottlerocketHostContainers,
 			BottlerocketCustomBootstrapContainers: scope.Config.Spec.ClusterConfiguration.BottlerocketCustomBootstrapContainers,
+			BottlerocketSettings:                  scope.Config.Spec.ClusterConfiguration.Bottlerocket,
 			Hostname:                              machine.Name,
 		}
 		if scope.Config.Spec.ClusterConfiguration.Proxy.HTTPSProxy != "" {
@@ -615,7 +616,6 @@ func (r *KubeadmConfigReconciler) handleClusterNotInitialized(ctx context.Contex
 		if scope.Config.Spec.NTP != nil && scope.Config.Spec.NTP.Enabled != nil && *scope.Config.Spec.NTP.Enabled {
 			bottlerocketConfig.NTPServers = scope.Config.Spec.NTP.Servers
 		}
-
 	}
 
 	clusterdata, err := kubeadmtypes.MarshalClusterConfigurationForVersion(scope.Config.Spec.ClusterConfiguration, parsedVersion)
@@ -906,6 +906,7 @@ func (r *KubeadmConfigReconciler) joinWorker(ctx context.Context, scope *Scope)
 			BottlerocketControl:                   scope.Config.Spec.JoinConfiguration.BottlerocketControl,
 			BottlerocketCustomHostContainers:      scope.Config.Spec.JoinConfiguration.BottlerocketCustomHostContainers,
 			BottlerocketCustomBootstrapContainers: scope.Config.Spec.JoinConfiguration.BottlerocketCustomBootstrapContainers,
+			BottlerocketSettings:                  scope.Config.Spec.JoinConfiguration.Bottlerocket,
 			Hostname:                              machine.Name,
 		}
 		if scope.Config.Spec.JoinConfiguration.Proxy.HTTPSProxy != "" {
@@ -1102,6 +1103,7 @@ func (r *KubeadmConfigReconciler) joinControlplane(ctx context.Context, scope *S
 			BottlerocketControl:                   scope.Config.Spec.JoinConfiguration.BottlerocketControl,
 			BottlerocketCustomHostContainers:      scope.Config.Spec.JoinConfiguration.BottlerocketCustomHostContainers,
 			BottlerocketCustomBootstrapContainers: scope.Config.Spec.JoinConfiguration.BottlerocketCustomBootstrapContainers,
+			BottlerocketSettings:                  scope.Config.Spec.JoinConfiguration.Bottlerocket,
 			Hostname:                              machine.Name,
 		}
 		if scope.Config.Spec.JoinConfiguration.Proxy.HTTPSProxy != "" {
diff --git a/bootstrap/kubeadm/types/upstreamv1beta1/types.go b/bootstrap/kubeadm/types/upstreamv1beta1/types.go
index 06344fb02..885c432ed 100644
--- a/bootstrap/kubeadm/types/upstreamv1beta1/types.go
+++ b/bootstrap/kubeadm/types/upstreamv1beta1/types.go
@@ -164,6 +164,31 @@ type ClusterConfiguration struct {
 	// This is only for bottlerocket.
 	// +optional
 	BottlerocketCustomBootstrapContainers []BottlerocketBootstrapContainer `json:"bottlerocketCustomBootstrapContainers,omitempty"`
+
+	// Bottlerocket holds configuration for certain bottlerocket settings.
+	// This is only for bottlerocket.
+	// +optional
+	Bottlerocket *BottlerocketSettings `json:"bottlerocket,omitempty"`
+}
+
+// BottlerocketSettings define bottlerocket settings that can be configured on bottlerocket nodes.
+// This setting is ONLY for bottlerocket nodes.
+type BottlerocketSettings struct {
+	// Kubernetes holds the kubernetes settings for bottlerocket nodes.
+	Kubernetes *BottlerocketKubernetesSettings `json:"kubernetes,omitempty"`
+}
+
+// BottlerocketKubernetesSettings holds the settings for kubernetes on bottlerocket nodes.
+// This setting is ONLY for bottlerocket nodes.
+type BottlerocketKubernetesSettings struct {
+	// MaxPods defines the maximum number of pods that can run on a node.
+	MaxPods int `json:"maxPods,omitempty"`
+
+	// AllowedUnsafeSysctls defines the list of unsafe sysctls that can be set on a node.
+	AllowedUnsafeSysctls []string `json:"allowedUnsafeSysctls,omitempty"`
+
+	// ClusterDNSIPs defines IP addresses of the DNS servers.
+	ClusterDNSIPs []string `json:"clusterDNSIPs,omitempty"`
 }
 
 // Pause defines the pause image repo and tag that should be run on the bootstrapped nodes.
@@ -474,6 +499,11 @@ type JoinConfiguration struct {
 	// This is only for bottlerocket.
 	// +optional
 	BottlerocketCustomBootstrapContainers []BottlerocketBootstrapContainer `json:"bottlerocketCustomBootstrapContainers,omitempty"`
+
+	// Bottlerocket holds configuration for certain bottlerocket settings.
+	// This is only for bottlerocket.
+	// +optional
+	Bottlerocket *BottlerocketSettings `json:"bottlerocket,omitempty"`
 }
 
 // BottlerocketHostContainer describes a host image for Bottlerocket
diff --git a/bootstrap/kubeadm/types/upstreamv1beta1/zz_generated.deepcopy.go b/bootstrap/kubeadm/types/upstreamv1beta1/zz_generated.deepcopy.go
index 1e89c7c78..5699dff61 100644
--- a/bootstrap/kubeadm/types/upstreamv1beta1/zz_generated.deepcopy.go
+++ b/bootstrap/kubeadm/types/upstreamv1beta1/zz_generated.deepcopy.go
@@ -221,6 +221,51 @@ func (in *BottlerocketHostContainer) DeepCopy() *BottlerocketHostContainer {
 	return out
 }
 
+// DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
+func (in *BottlerocketKubernetesSettings) DeepCopyInto(out *BottlerocketKubernetesSettings) {
+	*out = *in
+	if in.AllowedUnsafeSysctls != nil {
+		in, out := &in.AllowedUnsafeSysctls, &out.AllowedUnsafeSysctls
+		*out = make([]string, len(*in))
+		copy(*out, *in)
+	}
+	if in.ClusterDNSIPs != nil {
+		in, out := &in.ClusterDNSIPs, &out.ClusterDNSIPs
+		*out = make([]string, len(*in))
+		copy(*out, *in)
+	}
+}
+
+// DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new BottlerocketKubernetesSettings.
+func (in *BottlerocketKubernetesSettings) DeepCopy() *BottlerocketKubernetesSettings {
+	if in == nil {
+		return nil
+	}
+	out := new(BottlerocketKubernetesSettings)
+	in.DeepCopyInto(out)
+	return out
+}
+
+// DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
+func (in *BottlerocketSettings) DeepCopyInto(out *BottlerocketSettings) {
+	*out = *in
+	if in.Kubernetes != nil {
+		in, out := &in.Kubernetes, &out.Kubernetes
+		*out = new(BottlerocketKubernetesSettings)
+		(*in).DeepCopyInto(*out)
+	}
+}
+
+// DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new BottlerocketSettings.
+func (in *BottlerocketSettings) DeepCopy() *BottlerocketSettings {
+	if in == nil {
+		return nil
+	}
+	out := new(BottlerocketSettings)
+	in.DeepCopyInto(out)
+	return out
+}
+
 // DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
 func (in *ClusterConfiguration) DeepCopyInto(out *ClusterConfiguration) {
 	*out = *in
@@ -254,6 +299,11 @@ func (in *ClusterConfiguration) DeepCopyInto(out *ClusterConfiguration) {
 		*out = make([]BottlerocketBootstrapContainer, len(*in))
 		copy(*out, *in)
 	}
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(BottlerocketSettings)
+		(*in).DeepCopyInto(*out)
+	}
 }
 
 // DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new ClusterConfiguration.
@@ -528,6 +578,11 @@ func (in *JoinConfiguration) DeepCopyInto(out *JoinConfiguration) {
 		*out = make([]BottlerocketBootstrapContainer, len(*in))
 		copy(*out, *in)
 	}
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(BottlerocketSettings)
+		(*in).DeepCopyInto(*out)
+	}
 }
 
 // DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new JoinConfiguration.
diff --git a/bootstrap/kubeadm/types/upstreamv1beta2/zz_generated.conversion.go b/bootstrap/kubeadm/types/upstreamv1beta2/zz_generated.conversion.go
index e92a0f7e7..b34a12f3c 100644
--- a/bootstrap/kubeadm/types/upstreamv1beta2/zz_generated.conversion.go
+++ b/bootstrap/kubeadm/types/upstreamv1beta2/zz_generated.conversion.go
@@ -564,6 +564,7 @@ func autoConvert_v1beta1_ClusterConfiguration_To_upstreamv1beta2_ClusterConfigur
 	out.ClusterName = in.ClusterName
 	// WARNING: in.BottlerocketHostContainers requires manual conversion: does not exist in peer-type
 	// WARNING: in.BottlerocketCustomBootstrapContainers requires manual conversion: does not exist in peer-type
+	// WARNING: in.Bottlerocket requires manual conversion: does not exist in peer-type
 	return nil
 }
 
@@ -904,6 +905,7 @@ func autoConvert_v1beta1_JoinConfiguration_To_upstreamv1beta2_JoinConfiguration(
 	// WARNING: in.Patches requires manual conversion: does not exist in peer-type
 	// WARNING: in.BottlerocketCustomHostContainers requires manual conversion: does not exist in peer-type
 	// WARNING: in.BottlerocketCustomBootstrapContainers requires manual conversion: does not exist in peer-type
+	// WARNING: in.Bottlerocket requires manual conversion: does not exist in peer-type
 	return nil
 }
 
diff --git a/bootstrap/kubeadm/types/upstreamv1beta3/zz_generated.conversion.go b/bootstrap/kubeadm/types/upstreamv1beta3/zz_generated.conversion.go
index 23699e084..9a5349623 100644
--- a/bootstrap/kubeadm/types/upstreamv1beta3/zz_generated.conversion.go
+++ b/bootstrap/kubeadm/types/upstreamv1beta3/zz_generated.conversion.go
@@ -568,6 +568,7 @@ func autoConvert_v1beta1_ClusterConfiguration_To_upstreamv1beta3_ClusterConfigur
 	out.ClusterName = in.ClusterName
 	// WARNING: in.BottlerocketHostContainers requires manual conversion: does not exist in peer-type
 	// WARNING: in.BottlerocketCustomBootstrapContainers requires manual conversion: does not exist in peer-type
+	// WARNING: in.Bottlerocket requires manual conversion: does not exist in peer-type
 	return nil
 }
 
@@ -901,6 +902,7 @@ func autoConvert_v1beta1_JoinConfiguration_To_upstreamv1beta3_JoinConfiguration(
 	out.Patches = (*Patches)(unsafe.Pointer(in.Patches))
 	// WARNING: in.BottlerocketCustomHostContainers requires manual conversion: does not exist in peer-type
 	// WARNING: in.BottlerocketCustomBootstrapContainers requires manual conversion: does not exist in peer-type
+	// WARNING: in.Bottlerocket requires manual conversion: does not exist in peer-type
 	return nil
 }
 
diff --git a/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanes.yaml b/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanes.yaml
index cf02856cd..640b9c710 100644
--- a/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanes.yaml
+++ b/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanes.yaml
@@ -194,6 +194,33 @@ spec:
                           may reject unrecognized values.
                           More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                         type: string
+                      bottlerocket:
+                        description: |-
+                          Bottlerocket holds configuration for certain bottlerocket settings.
+                          This is only for bottlerocket.
+                        properties:
+                          kubernetes:
+                            description: Kubernetes holds the kubernetes settings
+                              for bottlerocket nodes.
+                            properties:
+                              allowedUnsafeSysctls:
+                                description: AllowedUnsafeSysctls defines the list
+                                  of unsafe sysctls that can be set on a node.
+                                items:
+                                  type: string
+                                type: array
+                              clusterDNSIPs:
+                                description: ClusterDNSIPs defines IP addresses of
+                                  the DNS servers.
+                                items:
+                                  type: string
+                                type: array
+                              maxPods:
+                                description: MaxPods defines the maximum number of
+                                  pods that can run on a node.
+                                type: integer
+                            type: object
+                        type: object
                       bottlerocketAdmin:
                         description: |-
                           BottlerocketAdmin holds the image source for admin container
@@ -938,6 +965,33 @@ spec:
                           may reject unrecognized values.
                           More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                         type: string
+                      bottlerocket:
+                        description: |-
+                          Bottlerocket holds configuration for certain bottlerocket settings.
+                          This is only for bottlerocket.
+                        properties:
+                          kubernetes:
+                            description: Kubernetes holds the kubernetes settings
+                              for bottlerocket nodes.
+                            properties:
+                              allowedUnsafeSysctls:
+                                description: AllowedUnsafeSysctls defines the list
+                                  of unsafe sysctls that can be set on a node.
+                                items:
+                                  type: string
+                                type: array
+                              clusterDNSIPs:
+                                description: ClusterDNSIPs defines IP addresses of
+                                  the DNS servers.
+                                items:
+                                  type: string
+                                type: array
+                              maxPods:
+                                description: MaxPods defines the maximum number of
+                                  pods that can run on a node.
+                                type: integer
+                            type: object
+                        type: object
                       bottlerocketAdmin:
                         description: |-
                           BottlerocketAdmin holds the image source for admin container
@@ -1695,6 +1749,33 @@ spec:
                           may reject unrecognized values.
                           More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                         type: string
+                      bottlerocket:
+                        description: |-
+                          Bottlerocket holds configuration for certain bottlerocket settings.
+                          This is only for bottlerocket.
+                        properties:
+                          kubernetes:
+                            description: Kubernetes holds the kubernetes settings
+                              for bottlerocket nodes.
+                            properties:
+                              allowedUnsafeSysctls:
+                                description: AllowedUnsafeSysctls defines the list
+                                  of unsafe sysctls that can be set on a node.
+                                items:
+                                  type: string
+                                type: array
+                              clusterDNSIPs:
+                                description: ClusterDNSIPs defines IP addresses of
+                                  the DNS servers.
+                                items:
+                                  type: string
+                                type: array
+                              maxPods:
+                                description: MaxPods defines the maximum number of
+                                  pods that can run on a node.
+                                type: integer
+                            type: object
+                        type: object
                       bottlerocketAdmin:
                         description: |-
                           BottlerocketAdmin holds the image source for admin container
@@ -2436,6 +2517,33 @@ spec:
                           may reject unrecognized values.
                           More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                         type: string
+                      bottlerocket:
+                        description: |-
+                          Bottlerocket holds configuration for certain bottlerocket settings.
+                          This is only for bottlerocket.
+                        properties:
+                          kubernetes:
+                            description: Kubernetes holds the kubernetes settings
+                              for bottlerocket nodes.
+                            properties:
+                              allowedUnsafeSysctls:
+                                description: AllowedUnsafeSysctls defines the list
+                                  of unsafe sysctls that can be set on a node.
+                                items:
+                                  type: string
+                                type: array
+                              clusterDNSIPs:
+                                description: ClusterDNSIPs defines IP addresses of
+                                  the DNS servers.
+                                items:
+                                  type: string
+                                type: array
+                              maxPods:
+                                description: MaxPods defines the maximum number of
+                                  pods that can run on a node.
+                                type: integer
+                            type: object
+                        type: object
                       bottlerocketAdmin:
                         description: |-
                           BottlerocketAdmin holds the image source for admin container
@@ -3434,6 +3542,33 @@ spec:
                           may reject unrecognized values.
                           More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                         type: string
+                      bottlerocket:
+                        description: |-
+                          Bottlerocket holds configuration for certain bottlerocket settings.
+                          This is only for bottlerocket.
+                        properties:
+                          kubernetes:
+                            description: Kubernetes holds the kubernetes settings
+                              for bottlerocket nodes.
+                            properties:
+                              allowedUnsafeSysctls:
+                                description: AllowedUnsafeSysctls defines the list
+                                  of unsafe sysctls that can be set on a node.
+                                items:
+                                  type: string
+                                type: array
+                              clusterDNSIPs:
+                                description: ClusterDNSIPs defines IP addresses of
+                                  the DNS servers.
+                                items:
+                                  type: string
+                                type: array
+                              maxPods:
+                                description: MaxPods defines the maximum number of
+                                  pods that can run on a node.
+                                type: integer
+                            type: object
+                        type: object
                       bottlerocketAdmin:
                         description: |-
                           BottlerocketAdmin holds the image source for admin container
@@ -4787,6 +4922,33 @@ spec:
                           may reject unrecognized values.
                           More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                         type: string
+                      bottlerocket:
+                        description: |-
+                          Bottlerocket holds configuration for certain bottlerocket settings.
+                          This is only for bottlerocket.
+                        properties:
+                          kubernetes:
+                            description: Kubernetes holds the kubernetes settings
+                              for bottlerocket nodes.
+                            properties:
+                              allowedUnsafeSysctls:
+                                description: AllowedUnsafeSysctls defines the list
+                                  of unsafe sysctls that can be set on a node.
+                                items:
+                                  type: string
+                                type: array
+                              clusterDNSIPs:
+                                description: ClusterDNSIPs defines IP addresses of
+                                  the DNS servers.
+                                items:
+                                  type: string
+                                type: array
+                              maxPods:
+                                description: MaxPods defines the maximum number of
+                                  pods that can run on a node.
+                                type: integer
+                            type: object
+                        type: object
                       bottlerocketAdmin:
                         description: |-
                           BottlerocketAdmin holds the image source for admin container
diff --git a/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanetemplates.yaml b/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanetemplates.yaml
index a2b5853be..d4361d768 100644
--- a/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanetemplates.yaml
+++ b/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanetemplates.yaml
@@ -128,6 +128,34 @@ spec:
                                   may reject unrecognized values.
                                   More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                                 type: string
+                              bottlerocket:
+                                description: |-
+                                  Bottlerocket holds configuration for certain bottlerocket settings.
+                                  This is only for bottlerocket.
+                                properties:
+                                  kubernetes:
+                                    description: Kubernetes holds the kubernetes settings
+                                      for bottlerocket nodes.
+                                    properties:
+                                      allowedUnsafeSysctls:
+                                        description: AllowedUnsafeSysctls defines
+                                          the list of unsafe sysctls that can be set
+                                          on a node.
+                                        items:
+                                          type: string
+                                        type: array
+                                      clusterDNSIPs:
+                                        description: ClusterDNSIPs defines IP addresses
+                                          of the DNS servers.
+                                        items:
+                                          type: string
+                                        type: array
+                                      maxPods:
+                                        description: MaxPods defines the maximum number
+                                          of pods that can run on a node.
+                                        type: integer
+                                    type: object
+                                type: object
                               bottlerocketAdmin:
                                 description: |-
                                   BottlerocketAdmin holds the image source for admin container
@@ -883,6 +911,34 @@ spec:
                                   may reject unrecognized values.
                                   More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                                 type: string
+                              bottlerocket:
+                                description: |-
+                                  Bottlerocket holds configuration for certain bottlerocket settings.
+                                  This is only for bottlerocket.
+                                properties:
+                                  kubernetes:
+                                    description: Kubernetes holds the kubernetes settings
+                                      for bottlerocket nodes.
+                                    properties:
+                                      allowedUnsafeSysctls:
+                                        description: AllowedUnsafeSysctls defines
+                                          the list of unsafe sysctls that can be set
+                                          on a node.
+                                        items:
+                                          type: string
+                                        type: array
+                                      clusterDNSIPs:
+                                        description: ClusterDNSIPs defines IP addresses
+                                          of the DNS servers.
+                                        items:
+                                          type: string
+                                        type: array
+                                      maxPods:
+                                        description: MaxPods defines the maximum number
+                                          of pods that can run on a node.
+                                        type: integer
+                                    type: object
+                                type: object
                               bottlerocketAdmin:
                                 description: |-
                                   BottlerocketAdmin holds the image source for admin container
@@ -1776,6 +1832,34 @@ spec:
                                   may reject unrecognized values.
                                   More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                                 type: string
+                              bottlerocket:
+                                description: |-
+                                  Bottlerocket holds configuration for certain bottlerocket settings.
+                                  This is only for bottlerocket.
+                                properties:
+                                  kubernetes:
+                                    description: Kubernetes holds the kubernetes settings
+                                      for bottlerocket nodes.
+                                    properties:
+                                      allowedUnsafeSysctls:
+                                        description: AllowedUnsafeSysctls defines
+                                          the list of unsafe sysctls that can be set
+                                          on a node.
+                                        items:
+                                          type: string
+                                        type: array
+                                      clusterDNSIPs:
+                                        description: ClusterDNSIPs defines IP addresses
+                                          of the DNS servers.
+                                        items:
+                                          type: string
+                                        type: array
+                                      maxPods:
+                                        description: MaxPods defines the maximum number
+                                          of pods that can run on a node.
+                                        type: integer
+                                    type: object
+                                type: object
                               bottlerocketAdmin:
                                 description: |-
                                   BottlerocketAdmin holds the image source for admin container
@@ -3161,6 +3245,34 @@ spec:
                                   may reject unrecognized values.
                                   More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                                 type: string
+                              bottlerocket:
+                                description: |-
+                                  Bottlerocket holds configuration for certain bottlerocket settings.
+                                  This is only for bottlerocket.
+                                properties:
+                                  kubernetes:
+                                    description: Kubernetes holds the kubernetes settings
+                                      for bottlerocket nodes.
+                                    properties:
+                                      allowedUnsafeSysctls:
+                                        description: AllowedUnsafeSysctls defines
+                                          the list of unsafe sysctls that can be set
+                                          on a node.
+                                        items:
+                                          type: string
+                                        type: array
+                                      clusterDNSIPs:
+                                        description: ClusterDNSIPs defines IP addresses
+                                          of the DNS servers.
+                                        items:
+                                          type: string
+                                        type: array
+                                      maxPods:
+                                        description: MaxPods defines the maximum number
+                                          of pods that can run on a node.
+                                        type: integer
+                                    type: object
+                                type: object
                               bottlerocketAdmin:
                                 description: |-
                                   BottlerocketAdmin holds the image source for admin container
diff --git a/controlplane/kubeadm/internal/webhooks/kubeadm_control_plane.go b/controlplane/kubeadm/internal/webhooks/kubeadm_control_plane.go
index 38b5c273b..6586dac09 100644
--- a/controlplane/kubeadm/internal/webhooks/kubeadm_control_plane.go
+++ b/controlplane/kubeadm/internal/webhooks/kubeadm_control_plane.go
@@ -171,6 +171,7 @@ func (webhook *KubeadmControlPlane) ValidateUpdate(_ context.Context, oldObj, ne
 		{spec, kubeadmConfigSpec, clusterConfiguration, "bottlerocketAdmin", "*"},
 		{spec, kubeadmConfigSpec, clusterConfiguration, "bottlerocketControl", "*"},
 		{spec, kubeadmConfigSpec, clusterConfiguration, "bottlerocketCustomBootstrapContainers"},
+		{spec, kubeadmConfigSpec, clusterConfiguration, "bottlerocketSettings", "*"},
 		{spec, kubeadmConfigSpec, clusterConfiguration, "pause", "*"},
 		{spec, kubeadmConfigSpec, clusterConfiguration, "etcd", "local", "imageRepository"},
 		{spec, kubeadmConfigSpec, clusterConfiguration, "etcd", "local", "imageTag"},
@@ -218,6 +219,7 @@ func (webhook *KubeadmControlPlane) ValidateUpdate(_ context.Context, oldObj, ne
 		{spec, kubeadmConfigSpec, joinConfiguration, "bottlerocketAdmin", "*"},
 		{spec, kubeadmConfigSpec, joinConfiguration, "bottlerocketControl", "*"},
 		{spec, kubeadmConfigSpec, joinConfiguration, "bottlerocketCustomBootstrapContainers"},
+		{spec, kubeadmConfigSpec, joinConfiguration, "bottlerocketSettings", "*"},
 		{spec, kubeadmConfigSpec, joinConfiguration, "pause", "*"},
 		// spec.kubeadmConfigSpec
 		{spec, kubeadmConfigSpec, bootCommands},
diff --git a/internal/apis/bootstrap/kubeadm/v1alpha4/kubeadm_types.go b/internal/apis/bootstrap/kubeadm/v1alpha4/kubeadm_types.go
index d8fc66fa5..a104af02d 100644
--- a/internal/apis/bootstrap/kubeadm/v1alpha4/kubeadm_types.go
+++ b/internal/apis/bootstrap/kubeadm/v1alpha4/kubeadm_types.go
@@ -166,6 +166,31 @@ type ClusterConfiguration struct {
 	// This is only for bottlerocket.
 	// +optional
 	BottlerocketCustomBootstrapContainers []BottlerocketBootstrapContainer `json:"bottlerocketCustomBootstrapContainers,omitempty"`
+
+	// Bottlerocket holds configuration for certain bottlerocket settings.
+	// This is only for bottlerocket.
+	// +optional
+	Bottlerocket *BottlerocketSettings `json:"bottlerocket,omitempty"`
+}
+
+// BottlerocketSettings define bottlerocket settings that can be configured on bottlerocket nodes.
+// This setting is ONLY for bottlerocket nodes.
+type BottlerocketSettings struct {
+	// Kubernetes holds the kubernetes settings for bottlerocket nodes.
+	Kubernetes *BottlerocketKubernetesSettings `json:"kubernetes,omitempty"`
+}
+
+// BottlerocketKubernetesSettings holds the settings for kubernetes on bottlerocket nodes.
+// This setting is ONLY for bottlerocket nodes.
+type BottlerocketKubernetesSettings struct {
+	// MaxPods defines the maximum number of pods that can run on a node.
+	MaxPods int `json:"maxPods,omitempty"`
+
+	// AllowedUnsafeSysctls defines the list of unsafe sysctls that can be set on a node.
+	AllowedUnsafeSysctls []string `json:"allowedUnsafeSysctls,omitempty"`
+
+	// ClusterDNSIPs defines IP addresses of the DNS servers.
+	ClusterDNSIPs []string `json:"clusterDNSIPs,omitempty"`
 }
 
 // Pause defines the pause image repo and tag that should be run on the bootstrapped nodes.
@@ -485,6 +510,11 @@ type JoinConfiguration struct {
 	// This is only for bottlerocket.
 	// +optional
 	BottlerocketCustomBootstrapContainers []BottlerocketBootstrapContainer `json:"bottlerocketCustomBootstrapContainers,omitempty"`
+
+	// Bottlerocket holds configuration for certain bottlerocket settings.
+	// This is only for bottlerocket.
+	// +optional
+	Bottlerocket *BottlerocketSettings `json:"bottlerocket,omitempty"`
 }
 
 // BottlerocketHostContainer describes a host image for Bottlerocket
diff --git a/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.conversion.go b/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.conversion.go
index a6fe51a66..4c9eb3425 100644
--- a/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.conversion.go
+++ b/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.conversion.go
@@ -140,6 +140,26 @@ func RegisterConversions(s *runtime.Scheme) error {
 	}); err != nil {
 		return err
 	}
+	if err := s.AddGeneratedConversionFunc((*BottlerocketKubernetesSettings)(nil), (*v1beta1.BottlerocketKubernetesSettings)(nil), func(a, b interface{}, scope conversion.Scope) error {
+		return Convert_v1alpha4_BottlerocketKubernetesSettings_To_v1beta1_BottlerocketKubernetesSettings(a.(*BottlerocketKubernetesSettings), b.(*v1beta1.BottlerocketKubernetesSettings), scope)
+	}); err != nil {
+		return err
+	}
+	if err := s.AddGeneratedConversionFunc((*v1beta1.BottlerocketKubernetesSettings)(nil), (*BottlerocketKubernetesSettings)(nil), func(a, b interface{}, scope conversion.Scope) error {
+		return Convert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(a.(*v1beta1.BottlerocketKubernetesSettings), b.(*BottlerocketKubernetesSettings), scope)
+	}); err != nil {
+		return err
+	}
+	if err := s.AddGeneratedConversionFunc((*BottlerocketSettings)(nil), (*v1beta1.BottlerocketSettings)(nil), func(a, b interface{}, scope conversion.Scope) error {
+		return Convert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(a.(*BottlerocketSettings), b.(*v1beta1.BottlerocketSettings), scope)
+	}); err != nil {
+		return err
+	}
+	if err := s.AddGeneratedConversionFunc((*v1beta1.BottlerocketSettings)(nil), (*BottlerocketSettings)(nil), func(a, b interface{}, scope conversion.Scope) error {
+		return Convert_v1beta1_BottlerocketSettings_To_v1alpha4_BottlerocketSettings(a.(*v1beta1.BottlerocketSettings), b.(*BottlerocketSettings), scope)
+	}); err != nil {
+		return err
+	}
 	if err := s.AddGeneratedConversionFunc((*ClusterConfiguration)(nil), (*v1beta1.ClusterConfiguration)(nil), func(a, b interface{}, scope conversion.Scope) error {
 		return Convert_v1alpha4_ClusterConfiguration_To_v1beta1_ClusterConfiguration(a.(*ClusterConfiguration), b.(*v1beta1.ClusterConfiguration), scope)
 	}); err != nil {
@@ -755,6 +775,50 @@ func Convert_v1beta1_BottlerocketHostContainer_To_v1alpha4_BottlerocketHostConta
 	return autoConvert_v1beta1_BottlerocketHostContainer_To_v1alpha4_BottlerocketHostContainer(in, out, s)
 }
 
+func autoConvert_v1alpha4_BottlerocketKubernetesSettings_To_v1beta1_BottlerocketKubernetesSettings(in *BottlerocketKubernetesSettings, out *v1beta1.BottlerocketKubernetesSettings, s conversion.Scope) error {
+	out.MaxPods = in.MaxPods
+	out.AllowedUnsafeSysctls = *(*[]string)(unsafe.Pointer(&in.AllowedUnsafeSysctls))
+	out.ClusterDNSIPs = *(*[]string)(unsafe.Pointer(&in.ClusterDNSIPs))
+	return nil
+}
+
+// Convert_v1alpha4_BottlerocketKubernetesSettings_To_v1beta1_BottlerocketKubernetesSettings is an autogenerated conversion function.
+func Convert_v1alpha4_BottlerocketKubernetesSettings_To_v1beta1_BottlerocketKubernetesSettings(in *BottlerocketKubernetesSettings, out *v1beta1.BottlerocketKubernetesSettings, s conversion.Scope) error {
+	return autoConvert_v1alpha4_BottlerocketKubernetesSettings_To_v1beta1_BottlerocketKubernetesSettings(in, out, s)
+}
+
+func autoConvert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(in *v1beta1.BottlerocketKubernetesSettings, out *BottlerocketKubernetesSettings, s conversion.Scope) error {
+	out.MaxPods = in.MaxPods
+	out.AllowedUnsafeSysctls = *(*[]string)(unsafe.Pointer(&in.AllowedUnsafeSysctls))
+	out.ClusterDNSIPs = *(*[]string)(unsafe.Pointer(&in.ClusterDNSIPs))
+	return nil
+}
+
+// Convert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings is an autogenerated conversion function.
+func Convert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(in *v1beta1.BottlerocketKubernetesSettings, out *BottlerocketKubernetesSettings, s conversion.Scope) error {
+	return autoConvert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(in, out, s)
+}
+
+func autoConvert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(in *BottlerocketSettings, out *v1beta1.BottlerocketSettings, s conversion.Scope) error {
+	out.Kubernetes = (*v1beta1.BottlerocketKubernetesSettings)(unsafe.Pointer(in.Kubernetes))
+	return nil
+}
+
+// Convert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings is an autogenerated conversion function.
+func Convert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(in *BottlerocketSettings, out *v1beta1.BottlerocketSettings, s conversion.Scope) error {
+	return autoConvert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(in, out, s)
+}
+
+func autoConvert_v1beta1_BottlerocketSettings_To_v1alpha4_BottlerocketSettings(in *v1beta1.BottlerocketSettings, out *BottlerocketSettings, s conversion.Scope) error {
+	out.Kubernetes = (*BottlerocketKubernetesSettings)(unsafe.Pointer(in.Kubernetes))
+	return nil
+}
+
+// Convert_v1beta1_BottlerocketSettings_To_v1alpha4_BottlerocketSettings is an autogenerated conversion function.
+func Convert_v1beta1_BottlerocketSettings_To_v1alpha4_BottlerocketSettings(in *v1beta1.BottlerocketSettings, out *BottlerocketSettings, s conversion.Scope) error {
+	return autoConvert_v1beta1_BottlerocketSettings_To_v1alpha4_BottlerocketSettings(in, out, s)
+}
+
 func autoConvert_v1alpha4_ClusterConfiguration_To_v1beta1_ClusterConfiguration(in *ClusterConfiguration, out *v1beta1.ClusterConfiguration, s conversion.Scope) error {
 	if err := Convert_v1alpha4_Pause_To_v1beta1_Pause(&in.Pause, &out.Pause, s); err != nil {
 		return err
@@ -800,6 +864,7 @@ func autoConvert_v1alpha4_ClusterConfiguration_To_v1beta1_ClusterConfiguration(i
 	out.ClusterName = in.ClusterName
 	out.BottlerocketHostContainers = *(*[]v1beta1.BottlerocketHostContainer)(unsafe.Pointer(&in.BottlerocketHostContainers))
 	out.BottlerocketCustomBootstrapContainers = *(*[]v1beta1.BottlerocketBootstrapContainer)(unsafe.Pointer(&in.BottlerocketCustomBootstrapContainers))
+	out.Bottlerocket = (*v1beta1.BottlerocketSettings)(unsafe.Pointer(in.Bottlerocket))
 	return nil
 }
 
@@ -853,6 +918,7 @@ func autoConvert_v1beta1_ClusterConfiguration_To_v1alpha4_ClusterConfiguration(i
 	out.ClusterName = in.ClusterName
 	out.BottlerocketHostContainers = *(*[]BottlerocketHostContainer)(unsafe.Pointer(&in.BottlerocketHostContainers))
 	out.BottlerocketCustomBootstrapContainers = *(*[]BottlerocketBootstrapContainer)(unsafe.Pointer(&in.BottlerocketCustomBootstrapContainers))
+	out.Bottlerocket = (*BottlerocketSettings)(unsafe.Pointer(in.Bottlerocket))
 	return nil
 }
 
@@ -1252,6 +1318,7 @@ func autoConvert_v1alpha4_JoinConfiguration_To_v1beta1_JoinConfiguration(in *Joi
 	out.ControlPlane = (*v1beta1.JoinControlPlane)(unsafe.Pointer(in.ControlPlane))
 	out.BottlerocketCustomHostContainers = *(*[]v1beta1.BottlerocketHostContainer)(unsafe.Pointer(&in.BottlerocketCustomHostContainers))
 	out.BottlerocketCustomBootstrapContainers = *(*[]v1beta1.BottlerocketBootstrapContainer)(unsafe.Pointer(&in.BottlerocketCustomBootstrapContainers))
+	out.Bottlerocket = (*v1beta1.BottlerocketSettings)(unsafe.Pointer(in.Bottlerocket))
 	return nil
 }
 
@@ -1291,6 +1358,7 @@ func autoConvert_v1beta1_JoinConfiguration_To_v1alpha4_JoinConfiguration(in *v1b
 	// WARNING: in.Patches requires manual conversion: does not exist in peer-type
 	out.BottlerocketCustomHostContainers = *(*[]BottlerocketHostContainer)(unsafe.Pointer(&in.BottlerocketCustomHostContainers))
 	out.BottlerocketCustomBootstrapContainers = *(*[]BottlerocketBootstrapContainer)(unsafe.Pointer(&in.BottlerocketCustomBootstrapContainers))
+	out.Bottlerocket = (*BottlerocketSettings)(unsafe.Pointer(in.Bottlerocket))
 	return nil
 }
 
diff --git a/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.deepcopy.go b/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.deepcopy.go
index 082b6114c..9d54e9139 100644
--- a/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.deepcopy.go
+++ b/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.deepcopy.go
@@ -222,6 +222,51 @@ func (in *BottlerocketHostContainer) DeepCopy() *BottlerocketHostContainer {
 	return out
 }
 
+// DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
+func (in *BottlerocketKubernetesSettings) DeepCopyInto(out *BottlerocketKubernetesSettings) {
+	*out = *in
+	if in.AllowedUnsafeSysctls != nil {
+		in, out := &in.AllowedUnsafeSysctls, &out.AllowedUnsafeSysctls
+		*out = make([]string, len(*in))
+		copy(*out, *in)
+	}
+	if in.ClusterDNSIPs != nil {
+		in, out := &in.ClusterDNSIPs, &out.ClusterDNSIPs
+		*out = make([]string, len(*in))
+		copy(*out, *in)
+	}
+}
+
+// DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new BottlerocketKubernetesSettings.
+func (in *BottlerocketKubernetesSettings) DeepCopy() *BottlerocketKubernetesSettings {
+	if in == nil {
+		return nil
+	}
+	out := new(BottlerocketKubernetesSettings)
+	in.DeepCopyInto(out)
+	return out
+}
+
+// DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
+func (in *BottlerocketSettings) DeepCopyInto(out *BottlerocketSettings) {
+	*out = *in
+	if in.Kubernetes != nil {
+		in, out := &in.Kubernetes, &out.Kubernetes
+		*out = new(BottlerocketKubernetesSettings)
+		(*in).DeepCopyInto(*out)
+	}
+}
+
+// DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new BottlerocketSettings.
+func (in *BottlerocketSettings) DeepCopy() *BottlerocketSettings {
+	if in == nil {
+		return nil
+	}
+	out := new(BottlerocketSettings)
+	in.DeepCopyInto(out)
+	return out
+}
+
 // DeepCopyInto is an autogenerated deepcopy function, copying the receiver, writing into out. in must be non-nil.
 func (in *ClusterConfiguration) DeepCopyInto(out *ClusterConfiguration) {
 	*out = *in
@@ -255,6 +300,11 @@ func (in *ClusterConfiguration) DeepCopyInto(out *ClusterConfiguration) {
 		*out = make([]BottlerocketBootstrapContainer, len(*in))
 		copy(*out, *in)
 	}
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(BottlerocketSettings)
+		(*in).DeepCopyInto(*out)
+	}
 }
 
 // DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new ClusterConfiguration.
@@ -629,6 +679,11 @@ func (in *JoinConfiguration) DeepCopyInto(out *JoinConfiguration) {
 		*out = make([]BottlerocketBootstrapContainer, len(*in))
 		copy(*out, *in)
 	}
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(BottlerocketSettings)
+		(*in).DeepCopyInto(*out)
+	}
 }
 
 // DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new JoinConfiguration.
-- 
2.52.0

