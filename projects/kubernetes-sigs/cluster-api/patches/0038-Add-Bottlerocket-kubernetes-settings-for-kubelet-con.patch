From 271097dc7e041a0db4512e6b343e14fba6dbdfa7 Mon Sep 17 00:00:00 2001
From: Mitali Paygude <mitalipaygude@gmail.com>
Date: Fri, 31 May 2024 02:10:39 -0700
Subject: [PATCH 38/40] Add Bottlerocket kubernetes settings for kubelet
 configuration

---
 api/v1beta1/zz_generated.openapi.go           |  16 -
 .../kubeadm/api/v1beta1/kubeadm_types.go      | 103 ++++++-
 .../api/v1beta1/zz_generated.deepcopy.go      |  62 ++++
 ...strap.cluster.x-k8s.io_kubeadmconfigs.yaml | 276 +++++++++++++++++
 ...uster.x-k8s.io_kubeadmconfigtemplates.yaml | 278 +++++++++++++++++
 .../internal/bottlerocket/bootstrap.go        | 132 +++++++-
 .../internal/bottlerocket/bootstrap_test.go   | 123 +++++++-
 .../internal/bottlerocket/bottlerocket.go     | 128 ++++++--
 ...cluster.x-k8s.io_kubeadmcontrolplanes.yaml | 276 +++++++++++++++++
 ...x-k8s.io_kubeadmcontrolplanetemplates.yaml | 284 ++++++++++++++++++
 .../v1alpha4/zz_generated.conversion.go       | 100 +++++-
 11 files changed, 1720 insertions(+), 58 deletions(-)

diff --git a/api/v1beta1/zz_generated.openapi.go b/api/v1beta1/zz_generated.openapi.go
index 733e0e122..07f8a54df 100644
--- a/api/v1beta1/zz_generated.openapi.go
+++ b/api/v1beta1/zz_generated.openapi.go
@@ -1053,22 +1053,6 @@ func schema_sigsk8sio_cluster_api_api_v1beta1_ClusterStatus(ref common.Reference
 							Format:      "int64",
 						},
 					},
-					"managedExternalEtcdInitialized": {
-						SchemaProps: spec.SchemaProps{
-							Description: "ManagedExternalEtcdInitialized indicates that first etcd member's IP address is set by machine controller, so remaining etcd members can lookup the address to join the cluster",
-							Default:     false,
-							Type:        []string{"boolean"},
-							Format:      "",
-						},
-						},
-					"managedExternalEtcdReady": {
-						SchemaProps: spec.SchemaProps{
-							Description: "ManagedExternalEtcdReady indicates external etcd cluster is fully provisioned",
-							Default:     false,
-							Type:        []string{"boolean"},
-							Format:      "",
-						},
-					},
 					"v1beta2": {
 						SchemaProps: spec.SchemaProps{
 							Description: "v1beta2 groups all the fields that will be added or modified in Cluster's status with the V1Beta2 version.",
diff --git a/bootstrap/kubeadm/api/v1beta1/kubeadm_types.go b/bootstrap/kubeadm/api/v1beta1/kubeadm_types.go
index b7bd448cc..3d6438546 100644
--- a/bootstrap/kubeadm/api/v1beta1/kubeadm_types.go
+++ b/bootstrap/kubeadm/api/v1beta1/kubeadm_types.go
@@ -24,6 +24,7 @@ import (
 	"github.com/pkg/errors"
 	corev1 "k8s.io/api/core/v1"
 	metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"
+	v1 "k8s.io/apimachinery/pkg/apis/meta/v1"
 	bootstrapapi "k8s.io/cluster-bootstrap/token/api"
 	bootstraputil "k8s.io/cluster-bootstrap/token/util"
 )
@@ -213,14 +214,110 @@ type BottlerocketSettings struct {
 // BottlerocketKubernetesSettings holds the settings for kubernetes on bottlerocket nodes.
 // This setting is ONLY for bottlerocket nodes.
 type BottlerocketKubernetesSettings struct {
-	// MaxPods defines the maximum number of pods that can run on a node.
-	MaxPods int `json:"maxPods,omitempty"`
-
 	// AllowedUnsafeSysctls defines the list of unsafe sysctls that can be set on a node.
 	AllowedUnsafeSysctls []string `json:"allowedUnsafeSysctls,omitempty"`
 
 	// ClusterDNSIPs defines IP addresses of the DNS servers.
 	ClusterDNSIPs []string `json:"clusterDNSIPs,omitempty"`
+
+	// ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+	// to search this domain before the hostâ€™s search domains
+	ClusterDomain string `json:"clusterDomain,omitempty"`
+
+	// ContainerLogMaxFiles specifies the maximum number of container log
+	// files that can be present for a container
+	ContainerLogMaxFiles int `json:"containerLogMaxFiles,omitempty"`
+
+	// ContainerLogMaxSize is a quantity defining the maximum size of
+	// the container log file before it is rotated
+	ContainerLogMaxSize string `json:"containerLogMaxSize,omitempty"`
+
+	// CPUCFSQuota enables CPU CFS quota enforcement for containers that specify CPU limits
+	CPUCFSQuota *bool `json:"cpuCFSQuota,omitempty"`
+
+	// CPUManagerPolicy is the name of the policy to use.
+	CPUManagerPolicy string `json:"cpuManagerPolicy,omitempty"`
+
+	// CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+	// fine tune the behaviour of the cpu manager policies
+	CPUManagerPolicyOptions map[string]string `json:"cpuManagerPolicyOptions,omitempty"`
+
+	// CPUManagerReconcilePeriod is the reconciliation period for the CPU Manager.
+	CPUManagerReconcilePeriod *v1.Duration `json:"cpuManagerReconcilePeriod,omitempty"`
+
+	// EventBurst is the maximum size of a burst of event creations.
+	EventBurst int `json:"eventBurst,omitempty"`
+
+	// EventRecordQPS is the maximum event creations per second.
+	EventRecordQPS int `json:"eventRecordQPS,omitempty"`
+
+	// EvictionHard is a map of signal names to quantities that defines hard eviction thresholds.
+	EvictionHard map[string]string `json:"evictionHard,omitempty"`
+
+	// EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+	// when terminating pods in response to a soft eviction threshold being met.
+	EvictionMaxPodGracePeriod int `json:"evictionMaxPodGracePeriod,omitempty"`
+
+	// EvictionSoft is a map of signal names to quantities that defines soft eviction thresholds.
+	EvictionSoft map[string]string `json:"evictionSoft,omitempty"`
+
+	// EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+	// for each soft eviction signal.
+	EvictionSoftGracePeriod map[string]string `json:"evictionSoftGracePeriod,omitempty"`
+
+	// ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+	// collection is always run.
+	ImageGCHighThresholdPercent int `json:"imageGCHighThresholdPercent,omitempty"`
+
+	// ImageGCLowThresholdPercent is the percent of disk usage before which image garbage collection is never run.
+	ImageGCLowThresholdPercent int `json:"imageGCLowThresholdPercent,omitempty"`
+
+	// KubeAPIBurst  is the burst to allow while talking with kubernetes API server.
+	KubeAPIBurst int `json:"kubeAPIBurst,omitempty"`
+
+	// KubeAPIQPS is the QPS to use while talking with kubernetes apiserver.
+	KubeAPIQPS int `json:"kubeAPIQPS,omitempty"`
+
+	// KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+	// reserved for kubernetes system components
+	KubeReserved map[string]string `json:"kubeReserved,omitempty"`
+
+	// MaxPods defines the maximum number of pods that can run on a node.
+	MaxPods int `json:"maxPods,omitempty"`
+
+	// MemoryManagerPolicy is the name of the policy to use by memory manager.
+	MemoryManagerPolicy string `json:"memoryManagerPolicy,omitempty"`
+
+	// PodPidsLimit is the maximum number of PIDs in any pod.
+	PodPidsLimit int64 `json:"podPidsLimit,omitempty"`
+
+	// ProviderID sets the unique ID of the instance that an external provider.
+	ProviderID string `json:"providerID,omitempty"`
+
+	// RegistryBurst is the maximum size of bursty pulls.
+	RegistryBurst int `json:"registryBurst,omitempty"`
+
+	// RegistryPullQPS is the limit of registry pulls per second.
+	RegistryPullQPS int `json:"registryPullQPS,omitempty"`
+
+	// ShutdownGracePeriod specifies the total duration that the node should delay
+	// the shutdown and total grace period for pod termination during a node shutdown.
+	ShutdownGracePeriod *v1.Duration `json:"shutdownGracePeriod,omitempty"`
+
+	// ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+	// critical pods during a node shutdown.
+	ShutdownGracePeriodCriticalPods *v1.Duration `json:"shutdownGracePeriodCriticalPods,omitempty"`
+
+	// SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+	// resources reserved for non-kubernetes components.
+	SystemReserved map[string]string `json:"systemReserved,omitempty"`
+
+	// TopologyManagerPolicy is the name of the topology manager policy to use.
+	TopologyManagerPolicy string `json:"topologyManagerPolicy,omitempty"`
+
+	// TopologyManagerScope represents the scope of topology hint generation
+	// that topology manager requests and hint providers generate.
+	TopologyManagerScope string `json:"topologyManagerScope,omitempty"`
 }
 
 // BottlerocketKernelSettings holds the kernel settings for bottlerocket nodes
diff --git a/bootstrap/kubeadm/api/v1beta1/zz_generated.deepcopy.go b/bootstrap/kubeadm/api/v1beta1/zz_generated.deepcopy.go
index 7c0c2e735..2353cb4c9 100644
--- a/bootstrap/kubeadm/api/v1beta1/zz_generated.deepcopy.go
+++ b/bootstrap/kubeadm/api/v1beta1/zz_generated.deepcopy.go
@@ -288,6 +288,68 @@ func (in *BottlerocketKubernetesSettings) DeepCopyInto(out *BottlerocketKubernet
 		*out = make([]string, len(*in))
 		copy(*out, *in)
 	}
+	if in.CPUCFSQuota != nil {
+		in, out := &in.CPUCFSQuota, &out.CPUCFSQuota
+		*out = new(bool)
+		**out = **in
+	}
+	if in.CPUManagerPolicyOptions != nil {
+		in, out := &in.CPUManagerPolicyOptions, &out.CPUManagerPolicyOptions
+		*out = make(map[string]string, len(*in))
+		for key, val := range *in {
+			(*out)[key] = val
+		}
+	}
+	if in.CPUManagerReconcilePeriod != nil {
+		in, out := &in.CPUManagerReconcilePeriod, &out.CPUManagerReconcilePeriod
+		*out = new(v1.Duration)
+		**out = **in
+	}
+	if in.EvictionHard != nil {
+		in, out := &in.EvictionHard, &out.EvictionHard
+		*out = make(map[string]string, len(*in))
+		for key, val := range *in {
+			(*out)[key] = val
+		}
+	}
+	if in.EvictionSoft != nil {
+		in, out := &in.EvictionSoft, &out.EvictionSoft
+		*out = make(map[string]string, len(*in))
+		for key, val := range *in {
+			(*out)[key] = val
+		}
+	}
+	if in.EvictionSoftGracePeriod != nil {
+		in, out := &in.EvictionSoftGracePeriod, &out.EvictionSoftGracePeriod
+		*out = make(map[string]string, len(*in))
+		for key, val := range *in {
+			(*out)[key] = val
+		}
+	}
+	if in.KubeReserved != nil {
+		in, out := &in.KubeReserved, &out.KubeReserved
+		*out = make(map[string]string, len(*in))
+		for key, val := range *in {
+			(*out)[key] = val
+		}
+	}
+	if in.ShutdownGracePeriod != nil {
+		in, out := &in.ShutdownGracePeriod, &out.ShutdownGracePeriod
+		*out = new(v1.Duration)
+		**out = **in
+	}
+	if in.ShutdownGracePeriodCriticalPods != nil {
+		in, out := &in.ShutdownGracePeriodCriticalPods, &out.ShutdownGracePeriodCriticalPods
+		*out = new(v1.Duration)
+		**out = **in
+	}
+	if in.SystemReserved != nil {
+		in, out := &in.SystemReserved, &out.SystemReserved
+		*out = make(map[string]string, len(*in))
+		for key, val := range *in {
+			(*out)[key] = val
+		}
+	}
 }
 
 // DeepCopy is an autogenerated deepcopy function, copying the receiver, creating a new BottlerocketKubernetesSettings.
diff --git a/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigs.yaml b/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigs.yaml
index 18c1117ad..a39e22a5f 100644
--- a/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigs.yaml
+++ b/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigs.yaml
@@ -3308,10 +3308,148 @@ spec:
                             items:
                               type: string
                             type: array
+                          clusterDomain:
+                            description: |-
+                              ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+                              to search this domain before the hostâ€™s search domains
+                            type: string
+                          containerLogMaxFiles:
+                            description: |-
+                              ContainerLogMaxFiles specifies the maximum number of container log
+                              files that can be present for a container
+                            type: integer
+                          containerLogMaxSize:
+                            description: |-
+                              ContainerLogMaxSize is a quantity defining the maximum size of
+                              the container log file before it is rotated
+                            type: string
+                          cpuCFSQuota:
+                            description: CPUCFSQuota enables CPU CFS quota enforcement
+                              for containers that specify CPU limits
+                            type: boolean
+                          cpuManagerPolicy:
+                            description: CPUManagerPolicy is the name of the policy
+                              to use.
+                            type: string
+                          cpuManagerPolicyOptions:
+                            additionalProperties:
+                              type: string
+                            description: |-
+                              CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+                              fine tune the behaviour of the cpu manager policies
+                            type: object
+                          cpuManagerReconcilePeriod:
+                            description: CPUManagerReconcilePeriod is the reconciliation
+                              period for the CPU Manager.
+                            type: string
+                          eventBurst:
+                            description: EventBurst is the maximum size of a burst
+                              of event creations.
+                            type: integer
+                          eventRecordQPS:
+                            description: EventRecordQPS is the maximum event creations
+                              per second.
+                            type: integer
+                          evictionHard:
+                            additionalProperties:
+                              type: string
+                            description: EvictionHard is a map of signal names to
+                              quantities that defines hard eviction thresholds.
+                            type: object
+                          evictionMaxPodGracePeriod:
+                            description: |-
+                              EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+                              when terminating pods in response to a soft eviction threshold being met.
+                            type: integer
+                          evictionSoft:
+                            additionalProperties:
+                              type: string
+                            description: EvictionSoft is a map of signal names to
+                              quantities that defines soft eviction thresholds.
+                            type: object
+                          evictionSoftGracePeriod:
+                            additionalProperties:
+                              type: string
+                            description: |-
+                              EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+                              for each soft eviction signal.
+                            type: object
+                          imageGCHighThresholdPercent:
+                            description: |-
+                              ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+                              collection is always run.
+                            type: integer
+                          imageGCLowThresholdPercent:
+                            description: ImageGCLowThresholdPercent is the percent
+                              of disk usage before which image garbage collection
+                              is never run.
+                            type: integer
+                          kubeAPIBurst:
+                            description: KubeAPIBurst  is the burst to allow while
+                              talking with kubernetes API server.
+                            type: integer
+                          kubeAPIQPS:
+                            description: KubeAPIQPS is the QPS to use while talking
+                              with kubernetes apiserver.
+                            type: integer
+                          kubeReserved:
+                            additionalProperties:
+                              type: string
+                            description: |-
+                              KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+                              reserved for kubernetes system components
+                            type: object
                           maxPods:
                             description: MaxPods defines the maximum number of pods
                               that can run on a node.
                             type: integer
+                          memoryManagerPolicy:
+                            description: MemoryManagerPolicy is the name of the policy
+                              to use by memory manager.
+                            type: string
+                          podPidsLimit:
+                            description: PodPidsLimit is the maximum number of PIDs
+                              in any pod.
+                            format: int64
+                            type: integer
+                          providerID:
+                            description: ProviderID sets the unique ID of the instance
+                              that an external provider.
+                            type: string
+                          registryBurst:
+                            description: RegistryBurst is the maximum size of bursty
+                              pulls.
+                            type: integer
+                          registryPullQPS:
+                            description: RegistryPullQPS is the limit of registry
+                              pulls per second.
+                            type: integer
+                          shutdownGracePeriod:
+                            description: |-
+                              ShutdownGracePeriod specifies the total duration that the node should delay
+                              the shutdown and total grace period for pod termination during a node shutdown.
+                            type: string
+                          shutdownGracePeriodCriticalPods:
+                            description: |-
+                              ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+                              critical pods during a node shutdown.
+                            type: string
+                          systemReserved:
+                            additionalProperties:
+                              type: string
+                            description: |-
+                              SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+                              resources reserved for non-kubernetes components.
+                            type: object
+                          topologyManagerPolicy:
+                            description: TopologyManagerPolicy is the name of the
+                              topology manager policy to use.
+                            type: string
+                          topologyManagerScope:
+                            description: |-
+                              TopologyManagerScope represents the scope of topology hint generation
+                              that topology manager requests and hint providers generate.
+                            type: string
                         type: object
                     type: object
                   bottlerocketAdmin:
@@ -4628,10 +4766,148 @@ spec:
                             items:
                               type: string
                             type: array
+                          clusterDomain:
+                            description: |-
+                              ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+                              to search this domain before the hostâ€™s search domains
+                            type: string
+                          containerLogMaxFiles:
+                            description: |-
+                              ContainerLogMaxFiles specifies the maximum number of container log
+                              files that can be present for a container
+                            type: integer
+                          containerLogMaxSize:
+                            description: |-
+                              ContainerLogMaxSize is a quantity defining the maximum size of
+                              the container log file before it is rotated
+                            type: string
+                          cpuCFSQuota:
+                            description: CPUCFSQuota enables CPU CFS quota enforcement
+                              for containers that specify CPU limits
+                            type: boolean
+                          cpuManagerPolicy:
+                            description: CPUManagerPolicy is the name of the policy
+                              to use.
+                            type: string
+                          cpuManagerPolicyOptions:
+                            additionalProperties:
+                              type: string
+                            description: |-
+                              CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+                              fine tune the behaviour of the cpu manager policies
+                            type: object
+                          cpuManagerReconcilePeriod:
+                            description: CPUManagerReconcilePeriod is the reconciliation
+                              period for the CPU Manager.
+                            type: string
+                          eventBurst:
+                            description: EventBurst is the maximum size of a burst
+                              of event creations.
+                            type: integer
+                          eventRecordQPS:
+                            description: EventRecordQPS is the maximum event creations
+                              per second.
+                            type: integer
+                          evictionHard:
+                            additionalProperties:
+                              type: string
+                            description: EvictionHard is a map of signal names to
+                              quantities that defines hard eviction thresholds.
+                            type: object
+                          evictionMaxPodGracePeriod:
+                            description: |-
+                              EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+                              when terminating pods in response to a soft eviction threshold being met.
+                            type: integer
+                          evictionSoft:
+                            additionalProperties:
+                              type: string
+                            description: EvictionSoft is a map of signal names to
+                              quantities that defines soft eviction thresholds.
+                            type: object
+                          evictionSoftGracePeriod:
+                            additionalProperties:
+                              type: string
+                            description: |-
+                              EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+                              for each soft eviction signal.
+                            type: object
+                          imageGCHighThresholdPercent:
+                            description: |-
+                              ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+                              collection is always run.
+                            type: integer
+                          imageGCLowThresholdPercent:
+                            description: ImageGCLowThresholdPercent is the percent
+                              of disk usage before which image garbage collection
+                              is never run.
+                            type: integer
+                          kubeAPIBurst:
+                            description: KubeAPIBurst  is the burst to allow while
+                              talking with kubernetes API server.
+                            type: integer
+                          kubeAPIQPS:
+                            description: KubeAPIQPS is the QPS to use while talking
+                              with kubernetes apiserver.
+                            type: integer
+                          kubeReserved:
+                            additionalProperties:
+                              type: string
+                            description: |-
+                              KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+                              reserved for kubernetes system components
+                            type: object
                           maxPods:
                             description: MaxPods defines the maximum number of pods
                               that can run on a node.
                             type: integer
+                          memoryManagerPolicy:
+                            description: MemoryManagerPolicy is the name of the policy
+                              to use by memory manager.
+                            type: string
+                          podPidsLimit:
+                            description: PodPidsLimit is the maximum number of PIDs
+                              in any pod.
+                            format: int64
+                            type: integer
+                          providerID:
+                            description: ProviderID sets the unique ID of the instance
+                              that an external provider.
+                            type: string
+                          registryBurst:
+                            description: RegistryBurst is the maximum size of bursty
+                              pulls.
+                            type: integer
+                          registryPullQPS:
+                            description: RegistryPullQPS is the limit of registry
+                              pulls per second.
+                            type: integer
+                          shutdownGracePeriod:
+                            description: |-
+                              ShutdownGracePeriod specifies the total duration that the node should delay
+                              the shutdown and total grace period for pod termination during a node shutdown.
+                            type: string
+                          shutdownGracePeriodCriticalPods:
+                            description: |-
+                              ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+                              critical pods during a node shutdown.
+                            type: string
+                          systemReserved:
+                            additionalProperties:
+                              type: string
+                            description: |-
+                              SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+                              resources reserved for non-kubernetes components.
+                            type: object
+                          topologyManagerPolicy:
+                            description: TopologyManagerPolicy is the name of the
+                              topology manager policy to use.
+                            type: string
+                          topologyManagerScope:
+                            description: |-
+                              TopologyManagerScope represents the scope of topology hint generation
+                              that topology manager requests and hint providers generate.
+                            type: string
                         type: object
                     type: object
                   bottlerocketAdmin:
diff --git a/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigtemplates.yaml b/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigtemplates.yaml
index 5f5aa9261..dc7f2be43 100644
--- a/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigtemplates.yaml
+++ b/bootstrap/kubeadm/config/crd/bases/bootstrap.cluster.x-k8s.io_kubeadmconfigtemplates.yaml
@@ -3290,10 +3290,149 @@ spec:
                                     items:
                                       type: string
                                     type: array
+                                  clusterDomain:
+                                    description: |-
+                                      ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+                                      to search this domain before the hostâ€™s search domains
+                                    type: string
+                                  containerLogMaxFiles:
+                                    description: |-
+                                      ContainerLogMaxFiles specifies the maximum number of container log
+                                      files that can be present for a container
+                                    type: integer
+                                  containerLogMaxSize:
+                                    description: |-
+                                      ContainerLogMaxSize is a quantity defining the maximum size of
+                                      the container log file before it is rotated
+                                    type: string
+                                  cpuCFSQuota:
+                                    description: CPUCFSQuota enables CPU CFS quota
+                                      enforcement for containers that specify CPU
+                                      limits
+                                    type: boolean
+                                  cpuManagerPolicy:
+                                    description: CPUManagerPolicy is the name of the
+                                      policy to use.
+                                    type: string
+                                  cpuManagerPolicyOptions:
+                                    additionalProperties:
+                                      type: string
+                                    description: |-
+                                      CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+                                      fine tune the behaviour of the cpu manager policies
+                                    type: object
+                                  cpuManagerReconcilePeriod:
+                                    description: CPUManagerReconcilePeriod is the
+                                      reconciliation period for the CPU Manager.
+                                    type: string
+                                  eventBurst:
+                                    description: EventBurst is the maximum size of
+                                      a burst of event creations.
+                                    type: integer
+                                  eventRecordQPS:
+                                    description: EventRecordQPS is the maximum event
+                                      creations per second.
+                                    type: integer
+                                  evictionHard:
+                                    additionalProperties:
+                                      type: string
+                                    description: EvictionHard is a map of signal names
+                                      to quantities that defines hard eviction thresholds.
+                                    type: object
+                                  evictionMaxPodGracePeriod:
+                                    description: |-
+                                      EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+                                      when terminating pods in response to a soft eviction threshold being met.
+                                    type: integer
+                                  evictionSoft:
+                                    additionalProperties:
+                                      type: string
+                                    description: EvictionSoft is a map of signal names
+                                      to quantities that defines soft eviction thresholds.
+                                    type: object
+                                  evictionSoftGracePeriod:
+                                    additionalProperties:
+                                      type: string
+                                    description: |-
+                                      EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+                                      for each soft eviction signal.
+                                    type: object
+                                  imageGCHighThresholdPercent:
+                                    description: |-
+                                      ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+                                      collection is always run.
+                                    type: integer
+                                  imageGCLowThresholdPercent:
+                                    description: ImageGCLowThresholdPercent is the
+                                      percent of disk usage before which image garbage
+                                      collection is never run.
+                                    type: integer
+                                  kubeAPIBurst:
+                                    description: KubeAPIBurst  is the burst to allow
+                                      while talking with kubernetes API server.
+                                    type: integer
+                                  kubeAPIQPS:
+                                    description: KubeAPIQPS is the QPS to use while
+                                      talking with kubernetes apiserver.
+                                    type: integer
+                                  kubeReserved:
+                                    additionalProperties:
+                                      type: string
+                                    description: |-
+                                      KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+                                      reserved for kubernetes system components
+                                    type: object
                                   maxPods:
                                     description: MaxPods defines the maximum number
                                       of pods that can run on a node.
                                     type: integer
+                                  memoryManagerPolicy:
+                                    description: MemoryManagerPolicy is the name of
+                                      the policy to use by memory manager.
+                                    type: string
+                                  podPidsLimit:
+                                    description: PodPidsLimit is the maximum number
+                                      of PIDs in any pod.
+                                    format: int64
+                                    type: integer
+                                  providerID:
+                                    description: ProviderID sets the unique ID of
+                                      the instance that an external provider.
+                                    type: string
+                                  registryBurst:
+                                    description: RegistryBurst is the maximum size
+                                      of bursty pulls.
+                                    type: integer
+                                  registryPullQPS:
+                                    description: RegistryPullQPS is the limit of registry
+                                      pulls per second.
+                                    type: integer
+                                  shutdownGracePeriod:
+                                    description: |-
+                                      ShutdownGracePeriod specifies the total duration that the node should delay
+                                      the shutdown and total grace period for pod termination during a node shutdown.
+                                    type: string
+                                  shutdownGracePeriodCriticalPods:
+                                    description: |-
+                                      ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+                                      critical pods during a node shutdown.
+                                    type: string
+                                  systemReserved:
+                                    additionalProperties:
+                                      type: string
+                                    description: |-
+                                      SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+                                      resources reserved for non-kubernetes components.
+                                    type: object
+                                  topologyManagerPolicy:
+                                    description: TopologyManagerPolicy is the name
+                                      of the topology manager policy to use.
+                                    type: string
+                                  topologyManagerScope:
+                                    description: |-
+                                      TopologyManagerScope represents the scope of topology hint generation
+                                      that topology manager requests and hint providers generate.
+                                    type: string
                                 type: object
                             type: object
                           bottlerocketAdmin:
@@ -4649,10 +4788,149 @@ spec:
                                     items:
                                       type: string
                                     type: array
+                                  clusterDomain:
+                                    description: |-
+                                      ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+                                      to search this domain before the hostâ€™s search domains
+                                    type: string
+                                  containerLogMaxFiles:
+                                    description: |-
+                                      ContainerLogMaxFiles specifies the maximum number of container log
+                                      files that can be present for a container
+                                    type: integer
+                                  containerLogMaxSize:
+                                    description: |-
+                                      ContainerLogMaxSize is a quantity defining the maximum size of
+                                      the container log file before it is rotated
+                                    type: string
+                                  cpuCFSQuota:
+                                    description: CPUCFSQuota enables CPU CFS quota
+                                      enforcement for containers that specify CPU
+                                      limits
+                                    type: boolean
+                                  cpuManagerPolicy:
+                                    description: CPUManagerPolicy is the name of the
+                                      policy to use.
+                                    type: string
+                                  cpuManagerPolicyOptions:
+                                    additionalProperties:
+                                      type: string
+                                    description: |-
+                                      CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+                                      fine tune the behaviour of the cpu manager policies
+                                    type: object
+                                  cpuManagerReconcilePeriod:
+                                    description: CPUManagerReconcilePeriod is the
+                                      reconciliation period for the CPU Manager.
+                                    type: string
+                                  eventBurst:
+                                    description: EventBurst is the maximum size of
+                                      a burst of event creations.
+                                    type: integer
+                                  eventRecordQPS:
+                                    description: EventRecordQPS is the maximum event
+                                      creations per second.
+                                    type: integer
+                                  evictionHard:
+                                    additionalProperties:
+                                      type: string
+                                    description: EvictionHard is a map of signal names
+                                      to quantities that defines hard eviction thresholds.
+                                    type: object
+                                  evictionMaxPodGracePeriod:
+                                    description: |-
+                                      EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+                                      when terminating pods in response to a soft eviction threshold being met.
+                                    type: integer
+                                  evictionSoft:
+                                    additionalProperties:
+                                      type: string
+                                    description: EvictionSoft is a map of signal names
+                                      to quantities that defines soft eviction thresholds.
+                                    type: object
+                                  evictionSoftGracePeriod:
+                                    additionalProperties:
+                                      type: string
+                                    description: |-
+                                      EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+                                      for each soft eviction signal.
+                                    type: object
+                                  imageGCHighThresholdPercent:
+                                    description: |-
+                                      ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+                                      collection is always run.
+                                    type: integer
+                                  imageGCLowThresholdPercent:
+                                    description: ImageGCLowThresholdPercent is the
+                                      percent of disk usage before which image garbage
+                                      collection is never run.
+                                    type: integer
+                                  kubeAPIBurst:
+                                    description: KubeAPIBurst  is the burst to allow
+                                      while talking with kubernetes API server.
+                                    type: integer
+                                  kubeAPIQPS:
+                                    description: KubeAPIQPS is the QPS to use while
+                                      talking with kubernetes apiserver.
+                                    type: integer
+                                  kubeReserved:
+                                    additionalProperties:
+                                      type: string
+                                    description: |-
+                                      KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+                                      reserved for kubernetes system components
+                                    type: object
                                   maxPods:
                                     description: MaxPods defines the maximum number
                                       of pods that can run on a node.
                                     type: integer
+                                  memoryManagerPolicy:
+                                    description: MemoryManagerPolicy is the name of
+                                      the policy to use by memory manager.
+                                    type: string
+                                  podPidsLimit:
+                                    description: PodPidsLimit is the maximum number
+                                      of PIDs in any pod.
+                                    format: int64
+                                    type: integer
+                                  providerID:
+                                    description: ProviderID sets the unique ID of
+                                      the instance that an external provider.
+                                    type: string
+                                  registryBurst:
+                                    description: RegistryBurst is the maximum size
+                                      of bursty pulls.
+                                    type: integer
+                                  registryPullQPS:
+                                    description: RegistryPullQPS is the limit of registry
+                                      pulls per second.
+                                    type: integer
+                                  shutdownGracePeriod:
+                                    description: |-
+                                      ShutdownGracePeriod specifies the total duration that the node should delay
+                                      the shutdown and total grace period for pod termination during a node shutdown.
+                                    type: string
+                                  shutdownGracePeriodCriticalPods:
+                                    description: |-
+                                      ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+                                      critical pods during a node shutdown.
+                                    type: string
+                                  systemReserved:
+                                    additionalProperties:
+                                      type: string
+                                    description: |-
+                                      SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+                                      resources reserved for non-kubernetes components.
+                                    type: object
+                                  topologyManagerPolicy:
+                                    description: TopologyManagerPolicy is the name
+                                      of the topology manager policy to use.
+                                    type: string
+                                  topologyManagerScope:
+                                    description: |-
+                                      TopologyManagerScope represents the scope of topology hint generation
+                                      that topology manager requests and hint providers generate.
+                                    type: string
                                 type: object
                             type: object
                           bottlerocketAdmin:
diff --git a/bootstrap/kubeadm/internal/bottlerocket/bootstrap.go b/bootstrap/kubeadm/internal/bottlerocket/bootstrap.go
index f378c3362..8756d7473 100644
--- a/bootstrap/kubeadm/internal/bottlerocket/bootstrap.go
+++ b/bootstrap/kubeadm/internal/bottlerocket/bootstrap.go
@@ -5,7 +5,11 @@ package bottlerocket
 const (
 	kubernetesInitTemplate = `{{ define "kubernetesInitSettings" -}}
 [settings.kubernetes]
+{{- if .ClusterDomain }}
+cluster-domain = "{{.ClusterDomain}}"
+{{- else }}
 cluster-domain = "cluster.local"
+{{- end }}
 standalone-mode = true
 authentication-mode = "tls"
 server-tls-bootstrap = false
@@ -19,9 +23,116 @@ allowed-unsafe-sysctls = [{{stringsJoin .AllowedUnsafeSysctls ", " }}]
 {{- if .ClusterDNSIPs }}
 cluster-dns-ip = [{{stringsJoin .ClusterDNSIPs ", " }}]
 {{- end -}}
+{{- if ne .CPUCFSQuota nil }}
+cpu-cfs-quota-enforced = {{ .CPUCFSQuota }}
+{{- end -}}
 {{- if .MaxPods }}
 max-pods = {{.MaxPods}}
 {{- end -}}
+{{- if .ContainerLogMaxFiles }}
+container-log-max-files = {{.ContainerLogMaxFiles}}
+{{- end -}}
+{{- if .ContainerLogMaxSize }}
+container-log-max-size = "{{.ContainerLogMaxSize}}"
+{{- end -}}
+{{- if .CPUManagerPolicy }}
+cpu-manager-policy = "{{.CPUManagerPolicy}}"
+{{- if .CPUManagerPolicyOptions }}
+{{- range $key, $value := .CPUManagerPolicyOptions }}
+{{- if (eq $key "full-pcpus-only")}}
+cpu-manager-policy-options = ["{{ $key }}"]
+{{- end }}
+{{- end }}
+{{- end }}
+{{- end }}
+{{- if .CPUManagerReconcilePeriod }}
+cpu-manager-reconcile-period = {{.CPUManagerReconcilePeriod}}
+{{- end -}}
+{{- if .EventBurst }}
+event-burst = {{.EventBurst}}
+{{- end -}}
+{{- if .EventRecordQPS }}
+event-qps = {{.EventRecordQPS}}
+{{- end -}}
+{{- if .EvictionMaxPodGracePeriod }}
+eviction-max-pod-grace-period = {{.EvictionMaxPodGracePeriod}}
+{{- end -}}
+{{- if .ImageGCHighThresholdPercent }}
+image-gc-high-threshold-percent = {{.ImageGCHighThresholdPercent}}
+{{- end -}}
+{{- if .ImageGCLowThresholdPercent }}
+image-gc-low-threshold-percent = {{.ImageGCLowThresholdPercent}}
+{{- end -}}
+{{- if .KubeAPIBurst }}
+kube-api-burst = {{.KubeAPIBurst}}
+{{- end -}}
+{{- if .KubeAPIQPS }}
+kube-api-qps = {{.KubeAPIQPS}}
+{{- end -}}
+{{- if .MemoryManagerPolicy }}
+memory-manager-policy = "{{.MemoryManagerPolicy}}"
+{{- end -}}
+{{- if .PodPidsLimit }}
+pod-pids-limit = {{.PodPidsLimit}}
+{{- end -}}
+{{- if .RegistryBurst }}
+registry-burst = {{.RegistryBurst}}
+{{- end -}}
+{{- if .RegistryPullQPS }}
+registry-qps = {{.RegistryPullQPS}}
+{{- end -}}
+{{- if .ShutdownGracePeriod }}
+shutdown-grace-period = {{.ShutdownGracePeriod}}
+{{- end -}}
+{{- if .ShutdownGracePeriodCriticalPods }}
+shutdown-grace-period-for-critical-pods = {{.ShutdownGracePeriodCriticalPods}}
+{{- end -}}
+{{- if .TopologyManagerPolicy }}
+topology-manager-policy = "{{.TopologyManagerPolicy}}"
+{{- end -}}
+{{- if .TopologyManagerScope }}
+topology-manager-scope = "{{.TopologyManagerScope}}"
+{{- end -}}
+{{- end -}}
+`
+
+	evictionHardTemplate = `{{ define "evictionHardSettings" -}}
+[settings.kubernetes.eviction-hard]
+{{- range $key, $value := .EvictionHard }}
+"{{ $key }}" = "{{ $value }}"
+{{- end }}
+{{- end }}
+`
+
+	evictionSoftTemplate = `{{ define "evictionSoftSettings" -}}
+[settings.kubernetes.eviction-soft]
+{{- range $key, $value := .EvictionSoft }}
+"{{ $key }}" = "{{ $value }}"
+{{- end }}
+{{- end }}
+`
+
+	evictionSoftGracePeriodTemplate = `{{ define "evictionSoftGracePeriodSettings" -}}
+[settings.kubernetes.eviction-soft-grace-period]
+{{- range $key, $value := .EvictionSoftGracePeriod }}
+"{{ $key }}" = "{{ $value }}"
+{{- end }}
+{{- end }}
+`
+
+	kubeReservedTemplate = `{{ define "kubeReservedSettings" -}}
+[settings.kubernetes.kube-reserved]
+{{- range $key, $value := .KubeReserved }}
+{{ $key }} = "{{ $value }}"
+{{- end }}
+{{- end }}
+`
+
+	systemReservedTemplate = `{{ define "systemReservedSettings" -}}
+[settings.kubernetes.system-reserved]
+{{- range $key, $value := .SystemReserved }}
+{{ $key }} = "{{ $value }}"
+{{- end -}}
 {{- end -}}
 `
 
@@ -154,13 +265,32 @@ trusted = true
 
 {{template "kubernetesInitSettings" .}}
 
+{{- if .EvictionHard}}
+{{template "evictionHardSettings" .}}
+{{- end}}
+
+{{- if .EvictionSoft}}
+{{template "evictionSoftSettings" .}}
+{{- end}}
+
+{{- if .EvictionSoftGracePeriod}}
+{{template "evictionSoftGracePeriodSettings" .}}
+{{- end}}
+
+{{- if .KubeReserved}}
+{{template "kubeReservedSettings" .}}
+{{- end}}
+
+{{- if .SystemReserved}}
+{{template "systemReservedSettings" .}}
+{{- end}}
+
 {{template "networkInitSettings" .}}
 
 {{- if .BootstrapContainers}}
 {{template "bootstrapContainerSlice" .}}
 {{- end -}}
 
-
 {{- if .RegistryMirrorMap}}
 {{template "registryMirrorSettings" .}}
 {{- end -}}
diff --git a/bootstrap/kubeadm/internal/bottlerocket/bootstrap_test.go b/bootstrap/kubeadm/internal/bottlerocket/bootstrap_test.go
index ed58dc035..3c2007bb7 100644
--- a/bootstrap/kubeadm/internal/bottlerocket/bootstrap_test.go
+++ b/bootstrap/kubeadm/internal/bottlerocket/bootstrap_test.go
@@ -2,9 +2,12 @@ package bottlerocket
 
 import (
 	"testing"
+	"time"
 
 	. "github.com/onsi/gomega"
 	corev1 "k8s.io/api/core/v1"
+	v1 "k8s.io/apimachinery/pkg/apis/meta/v1"
+	"k8s.io/utils/pointer"
 
 	bootstrapv1 "sigs.k8s.io/cluster-api/bootstrap/kubeadm/api/v1beta1"
 )
@@ -378,6 +381,61 @@ endpoint = ["REGISTRY_ENDPOINT"]
 [settings.pki.registry-mirror-ca]
 data = "UkVHSVNUUllfQ0E="
 trusted=true`
+
+	kubernetesSettingsUserDataCPU = `
+[settings.host-containers.admin]
+enabled = true
+superpowered = true
+source = "ADMIN_REPO:ADMIN_TAG"
+user-data = "CnsKCSJzc2giOiB7CgkJImF1dGhvcml6ZWQta2V5cyI6IFsic3NoLXJzYSBBQUEuLi4iXQoJfQp9"
+[settings.host-containers.kubeadm-bootstrap]
+enabled = true
+superpowered = true
+source = "BOOTSTRAP_REPO:BOOTSTRAP_TAG"
+user-data = "Qk9UVExFUk9DS0VUX0JPT1RTVFJBUF9VU0VSREFUQQ=="
+
+[settings.kubernetes]
+cluster-domain = "cluster.local2"
+standalone-mode = true
+authentication-mode = "tls"
+server-tls-bootstrap = false
+pod-infra-container-image = "PAUSE_REPO:PAUSE_TAG"
+provider-id = "PROVIDERID"
+cpu-cfs-quota-enforced = false
+container-log-max-files = 10
+container-log-max-size = "5Mi"
+cpu-manager-policy = "static"
+cpu-manager-policy-options = ["full-pcpus-only"]
+cpu-manager-reconcile-period = 10s
+event-burst = 200
+event-qps = 100
+eviction-max-pod-grace-period = 10
+image-gc-high-threshold-percent = 26
+image-gc-low-threshold-percent = 19
+kube-api-burst = 80
+memory-manager-policy = "Static"
+pod-pids-limit = 10
+registry-burst = 11
+registry-qps = 1
+shutdown-grace-period = 15s
+shutdown-grace-period-for-critical-pods = 20s
+topology-manager-policy = "restricted"
+topology-manager-scope = "pod"
+[settings.kubernetes.eviction-hard]
+"memory.available" = "15%"
+[settings.kubernetes.eviction-soft]
+"memory.available" = "12%"
+[settings.kubernetes.eviction-soft-grace-period]
+"memory.available" = "30s"
+[settings.kubernetes.kube-reserved]
+cpu = "20m"
+[settings.kubernetes.system-reserved]
+cpu = "10m"
+ephemeral-storage = "1Gi"
+memory = "100Mi"
+
+[settings.network]
+hostname = "hostname"`
 )
 
 var (
@@ -686,11 +744,74 @@ func TestGetBottlerocketNodeUserData(t *testing.T) {
 			},
 			output: registryMirrorMultipleMirrorsUserData,
 		},
+		{
+			name: "with cpu manager policy options",
+			config: &BottlerocketConfig{
+				BottlerocketAdmin:     brAdmin,
+				BottlerocketBootstrap: brBootstrap,
+				Hostname:              hostname,
+				Pause:                 pause,
+				KubeletExtraArgs: map[string]string{
+					"provider-id": "PROVIDERID",
+				},
+				BottlerocketSettings: &bootstrapv1.BottlerocketSettings{
+					Kubernetes: &bootstrapv1.BottlerocketKubernetesSettings{
+						ClusterDomain:        "cluster.local2",
+						ContainerLogMaxFiles: 10,
+						ContainerLogMaxSize:  "5Mi",
+						CPUCFSQuota:          pointer.Bool(false),
+						CPUManagerPolicy:     "static",
+						CPUManagerPolicyOptions: map[string]string{
+							"full-pcpus-only": "true",
+						},
+						CPUManagerReconcilePeriod: &v1.Duration{
+							Duration: 10 * time.Second,
+						},
+						EventBurst:     200,
+						EventRecordQPS: 100,
+						EvictionHard: map[string]string{
+							"memory.available": "15%",
+						},
+						EvictionMaxPodGracePeriod: 10,
+						EvictionSoft: map[string]string{
+							"memory.available": "12%",
+						},
+						EvictionSoftGracePeriod: map[string]string{
+							"memory.available": "30s",
+						},
+						ImageGCHighThresholdPercent: 26,
+						ImageGCLowThresholdPercent:  19,
+						KubeAPIBurst:                80,
+						KubeReserved: map[string]string{
+							"cpu": "20m",
+						},
+						MemoryManagerPolicy: "Static",
+						PodPidsLimit:        10,
+						RegistryBurst:       11,
+						RegistryPullQPS:     1,
+						ShutdownGracePeriod: &v1.Duration{
+							Duration: 15 * time.Second,
+						},
+						ShutdownGracePeriodCriticalPods: &v1.Duration{
+							Duration: 20 * time.Second,
+						},
+						SystemReserved: map[string]string{
+							"cpu":               "10m",
+							"ephemeral-storage": "1Gi",
+							"memory":            "100Mi",
+						},
+						TopologyManagerPolicy: "restricted",
+						TopologyManagerScope:  "pod",
+					},
+				},
+			},
+			output: kubernetesSettingsUserDataCPU,
+		},
 	}
 	for _, testcase := range testcases {
 		t.Run(testcase.name, func(t *testing.T) {
 			b, err := getBottlerocketNodeUserData(brBootstrapUserdata, users, testcase.config)
-			println(string(b))
+
 			g.Expect(err).NotTo(HaveOccurred())
 			g.Expect(string(b)).To(Equal(testcase.output))
 		})
diff --git a/bootstrap/kubeadm/internal/bottlerocket/bottlerocket.go b/bootstrap/kubeadm/internal/bottlerocket/bottlerocket.go
index f596d7b01..ceab3c5e5 100644
--- a/bootstrap/kubeadm/internal/bottlerocket/bottlerocket.go
+++ b/bootstrap/kubeadm/internal/bottlerocket/bottlerocket.go
@@ -42,29 +42,56 @@ type BottlerocketConfig struct {
 	RegistryMirrorCredentials
 }
 
-// BottlerocketSettingsInput is the input for the Bottlerocket settings template.
-type BottlerocketSettingsInput struct {
-	PauseContainerSource   string
-	HTTPSProxyEndpoint     string
-	NoProxyEndpoints       []string
-	RegistryMirrorEndpoint string
-	RegistryMirrorCACert   string
-	RegistryMirrorUsername string
-	RegistryMirrorPassword string
-	NodeLabels             string
-	NTPServers             []string
-	Taints                 string
-	ProviderID             string
-	Hostname               string
-	AllowedUnsafeSysctls   []string
-	ClusterDNSIPs          []string
-	MaxPods                int
-	BootKernel             string
-	HostContainers         []bootstrapv1.BottlerocketHostContainer
-	BootstrapContainers    []bootstrapv1.BottlerocketBootstrapContainer
-	SysctlSettings         string
-	CertBundles            []bootstrapv1.CertBundle
-	RegistryMirrorMap      map[string][]string
+// SettingsInput is the input for the Bottlerocket settings template.
+type SettingsInput struct {
+	PauseContainerSource            string
+	HTTPSProxyEndpoint              string
+	NoProxyEndpoints                []string
+	RegistryMirrorEndpoint          string
+	RegistryMirrorCACert            string
+	RegistryMirrorUsername          string
+	RegistryMirrorPassword          string
+	NodeLabels                      string
+	NTPServers                      []string
+	Taints                          string
+	ProviderID                      string
+	Hostname                        string
+	AllowedUnsafeSysctls            []string
+	ClusterDNSIPs                   []string
+	MaxPods                         int
+	BootKernel                      string
+	HostContainers                  []bootstrapv1.BottlerocketHostContainer
+	BootstrapContainers             []bootstrapv1.BottlerocketBootstrapContainer
+	SysctlSettings                  string
+	CertBundles                     []bootstrapv1.CertBundle
+	RegistryMirrorMap               map[string][]string
+	ClusterDomain                   string
+	ContainerLogMaxFiles            int
+	ContainerLogMaxSize             string
+	CPUCFSQuota                     *bool
+	CPUManagerPolicy                string
+	CPUManagerPolicyOptions         map[string]string
+	CPUManagerReconcilePeriod       string
+	EventBurst                      int
+	EventRecordQPS                  int
+	EvictionHard                    map[string]string
+	EvictionMaxPodGracePeriod       int
+	EvictionSoft                    map[string]string
+	EvictionSoftGracePeriod         map[string]string
+	ImageGCHighThresholdPercent     int
+	ImageGCLowThresholdPercent      int
+	KubeAPIBurst                    int
+	KubeAPIQPS                      int
+	KubeReserved                    map[string]string
+	MemoryManagerPolicy             string
+	PodPidsLimit                    int64
+	RegistryBurst                   int
+	RegistryPullQPS                 int
+	ShutdownGracePeriod             string
+	ShutdownGracePeriodCriticalPods string
+	SystemReserved                  map[string]string
+	TopologyManagerPolicy           string
+	TopologyManagerScope            string
 }
 
 // HostPath holds the path and type of a host path volume.
@@ -141,6 +168,21 @@ func generateNodeUserData(kind string, tpl string, data interface{}) ([]byte, er
 	if _, err := tm.Parse(kubernetesInitTemplate); err != nil {
 		return nil, errors.Wrapf(err, "failed to parse kubernetes %s template", kind)
 	}
+	if _, err := tm.Parse(evictionHardTemplate); err != nil {
+		return nil, errors.Wrapf(err, "failed to parse evictionHardSettings %s template", kind)
+	}
+	if _, err := tm.Parse(evictionSoftTemplate); err != nil {
+		return nil, errors.Wrapf(err, "failed to parse evictionSoftSettings %s template", kind)
+	}
+	if _, err := tm.Parse(evictionSoftGracePeriodTemplate); err != nil {
+		return nil, errors.Wrapf(err, "failed to parse evictionSoftGracePeriodSettings %s template", kind)
+	}
+	if _, err := tm.Parse(kubeReservedTemplate); err != nil {
+		return nil, errors.Wrapf(err, "failed to parse kubeReservedSettings %s template", kind)
+	}
+	if _, err := tm.Parse(systemReservedTemplate); err != nil {
+		return nil, errors.Wrapf(err, "failed to parse systemReservedSettings %s template", kind)
+	}
 	if _, err := tm.Parse(networkInitTemplate); err != nil {
 		return nil, errors.Wrapf(err, "failed to parse networks %s template", kind)
 	}
@@ -228,7 +270,7 @@ func getBottlerocketNodeUserData(bootstrapContainerUserData []byte, users []boot
 		hostContainers = append(hostContainers, config.BottlerocketCustomHostContainers...)
 	}
 
-	bottlerocketInput := &BottlerocketSettingsInput{
+	bottlerocketInput := &SettingsInput{
 		PauseContainerSource: fmt.Sprintf("%s:%s", config.Pause.ImageRepository, config.Pause.ImageTag),
 		HTTPSProxyEndpoint:   config.ProxyConfiguration.HTTPSProxy,
 		NodeLabels:           parseNodeLabels(config.KubeletExtraArgs["node-labels"]), // empty string if it does not exist
@@ -283,14 +325,50 @@ func getBottlerocketNodeUserData(bootstrapContainerUserData []byte, users []boot
 	}
 	if config.BottlerocketSettings != nil {
 		if config.BottlerocketSettings.Kubernetes != nil {
-			bottlerocketInput.MaxPods = config.BottlerocketSettings.Kubernetes.MaxPods
 			for _, sysctl := range config.BottlerocketSettings.Kubernetes.AllowedUnsafeSysctls {
 				bottlerocketInput.AllowedUnsafeSysctls = append(bottlerocketInput.AllowedUnsafeSysctls, strconv.Quote(sysctl))
 			}
 			for _, ip := range config.BottlerocketSettings.Kubernetes.ClusterDNSIPs {
 				bottlerocketInput.ClusterDNSIPs = append(bottlerocketInput.ClusterDNSIPs, strconv.Quote(ip))
 			}
+			bottlerocketInput.ClusterDomain = config.BottlerocketSettings.Kubernetes.ClusterDomain
+			bottlerocketInput.ContainerLogMaxFiles = config.BottlerocketSettings.Kubernetes.ContainerLogMaxFiles
+			bottlerocketInput.ContainerLogMaxSize = config.BottlerocketSettings.Kubernetes.ContainerLogMaxSize
+			if config.BottlerocketSettings.Kubernetes.CPUCFSQuota != nil {
+				bottlerocketInput.CPUCFSQuota = config.BottlerocketSettings.Kubernetes.CPUCFSQuota
+			}
+			bottlerocketInput.CPUManagerPolicy = config.BottlerocketSettings.Kubernetes.CPUManagerPolicy
+			bottlerocketInput.CPUManagerPolicyOptions = config.BottlerocketSettings.Kubernetes.CPUManagerPolicyOptions
+			if config.BottlerocketSettings.Kubernetes.CPUManagerReconcilePeriod != nil {
+				bottlerocketInput.CPUManagerReconcilePeriod = config.BottlerocketSettings.Kubernetes.CPUManagerReconcilePeriod.Duration.String()
+			}
+			bottlerocketInput.EventBurst = config.BottlerocketSettings.Kubernetes.EventBurst
+			bottlerocketInput.EventRecordQPS = config.BottlerocketSettings.Kubernetes.EventRecordQPS
+			bottlerocketInput.EvictionHard = config.BottlerocketSettings.Kubernetes.EvictionHard
+			bottlerocketInput.EvictionMaxPodGracePeriod = config.BottlerocketSettings.Kubernetes.EvictionMaxPodGracePeriod
+			bottlerocketInput.EvictionSoft = config.BottlerocketSettings.Kubernetes.EvictionSoft
+			bottlerocketInput.EvictionSoftGracePeriod = config.BottlerocketSettings.Kubernetes.EvictionSoftGracePeriod
+			bottlerocketInput.ImageGCHighThresholdPercent = config.BottlerocketSettings.Kubernetes.ImageGCHighThresholdPercent
+			bottlerocketInput.ImageGCLowThresholdPercent = config.BottlerocketSettings.Kubernetes.ImageGCLowThresholdPercent
+			bottlerocketInput.KubeAPIBurst = config.BottlerocketSettings.Kubernetes.KubeAPIBurst
+			bottlerocketInput.KubeAPIQPS = config.BottlerocketSettings.Kubernetes.KubeAPIQPS
+			bottlerocketInput.KubeReserved = config.BottlerocketSettings.Kubernetes.KubeReserved
+			bottlerocketInput.MaxPods = config.BottlerocketSettings.Kubernetes.MaxPods
+			bottlerocketInput.MemoryManagerPolicy = config.BottlerocketSettings.Kubernetes.MemoryManagerPolicy
+			bottlerocketInput.PodPidsLimit = config.BottlerocketSettings.Kubernetes.PodPidsLimit
+			bottlerocketInput.RegistryBurst = config.BottlerocketSettings.Kubernetes.RegistryBurst
+			bottlerocketInput.RegistryPullQPS = config.BottlerocketSettings.Kubernetes.RegistryPullQPS
+			if config.BottlerocketSettings.Kubernetes.ShutdownGracePeriod != nil {
+				bottlerocketInput.ShutdownGracePeriod = config.BottlerocketSettings.Kubernetes.ShutdownGracePeriod.Duration.String()
+			}
+			if config.BottlerocketSettings.Kubernetes.ShutdownGracePeriodCriticalPods != nil {
+				bottlerocketInput.ShutdownGracePeriodCriticalPods = config.BottlerocketSettings.Kubernetes.ShutdownGracePeriodCriticalPods.Duration.String()
+			}
+			bottlerocketInput.SystemReserved = config.BottlerocketSettings.Kubernetes.SystemReserved
+			bottlerocketInput.TopologyManagerPolicy = config.BottlerocketSettings.Kubernetes.TopologyManagerPolicy
+			bottlerocketInput.TopologyManagerScope = config.BottlerocketSettings.Kubernetes.TopologyManagerScope
 		}
+
 		if config.BottlerocketSettings.Kernel != nil {
 			bottlerocketInput.SysctlSettings = parseSysctlSettings(config.BottlerocketSettings.Kernel.SysctlSettings)
 		}
diff --git a/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanes.yaml b/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanes.yaml
index 4ba682feb..0aa507af0 100644
--- a/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanes.yaml
+++ b/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanes.yaml
@@ -3795,10 +3795,148 @@ spec:
                                 items:
                                   type: string
                                 type: array
+                              clusterDomain:
+                                description: |-
+                                  ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+                                  to search this domain before the hostâ€™s search domains
+                                type: string
+                              containerLogMaxFiles:
+                                description: |-
+                                  ContainerLogMaxFiles specifies the maximum number of container log
+                                  files that can be present for a container
+                                type: integer
+                              containerLogMaxSize:
+                                description: |-
+                                  ContainerLogMaxSize is a quantity defining the maximum size of
+                                  the container log file before it is rotated
+                                type: string
+                              cpuCFSQuota:
+                                description: CPUCFSQuota enables CPU CFS quota enforcement
+                                  for containers that specify CPU limits
+                                type: boolean
+                              cpuManagerPolicy:
+                                description: CPUManagerPolicy is the name of the policy
+                                  to use.
+                                type: string
+                              cpuManagerPolicyOptions:
+                                additionalProperties:
+                                  type: string
+                                description: |-
+                                  CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+                                  fine tune the behaviour of the cpu manager policies
+                                type: object
+                              cpuManagerReconcilePeriod:
+                                description: CPUManagerReconcilePeriod is the reconciliation
+                                  period for the CPU Manager.
+                                type: string
+                              eventBurst:
+                                description: EventBurst is the maximum size of a burst
+                                  of event creations.
+                                type: integer
+                              eventRecordQPS:
+                                description: EventRecordQPS is the maximum event creations
+                                  per second.
+                                type: integer
+                              evictionHard:
+                                additionalProperties:
+                                  type: string
+                                description: EvictionHard is a map of signal names
+                                  to quantities that defines hard eviction thresholds.
+                                type: object
+                              evictionMaxPodGracePeriod:
+                                description: |-
+                                  EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+                                  when terminating pods in response to a soft eviction threshold being met.
+                                type: integer
+                              evictionSoft:
+                                additionalProperties:
+                                  type: string
+                                description: EvictionSoft is a map of signal names
+                                  to quantities that defines soft eviction thresholds.
+                                type: object
+                              evictionSoftGracePeriod:
+                                additionalProperties:
+                                  type: string
+                                description: |-
+                                  EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+                                  for each soft eviction signal.
+                                type: object
+                              imageGCHighThresholdPercent:
+                                description: |-
+                                  ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+                                  collection is always run.
+                                type: integer
+                              imageGCLowThresholdPercent:
+                                description: ImageGCLowThresholdPercent is the percent
+                                  of disk usage before which image garbage collection
+                                  is never run.
+                                type: integer
+                              kubeAPIBurst:
+                                description: KubeAPIBurst  is the burst to allow while
+                                  talking with kubernetes API server.
+                                type: integer
+                              kubeAPIQPS:
+                                description: KubeAPIQPS is the QPS to use while talking
+                                  with kubernetes apiserver.
+                                type: integer
+                              kubeReserved:
+                                additionalProperties:
+                                  type: string
+                                description: |-
+                                  KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+                                  reserved for kubernetes system components
+                                type: object
                               maxPods:
                                 description: MaxPods defines the maximum number of
                                   pods that can run on a node.
                                 type: integer
+                              memoryManagerPolicy:
+                                description: MemoryManagerPolicy is the name of the
+                                  policy to use by memory manager.
+                                type: string
+                              podPidsLimit:
+                                description: PodPidsLimit is the maximum number of
+                                  PIDs in any pod.
+                                format: int64
+                                type: integer
+                              providerID:
+                                description: ProviderID sets the unique ID of the
+                                  instance that an external provider.
+                                type: string
+                              registryBurst:
+                                description: RegistryBurst is the maximum size of
+                                  bursty pulls.
+                                type: integer
+                              registryPullQPS:
+                                description: RegistryPullQPS is the limit of registry
+                                  pulls per second.
+                                type: integer
+                              shutdownGracePeriod:
+                                description: |-
+                                  ShutdownGracePeriod specifies the total duration that the node should delay
+                                  the shutdown and total grace period for pod termination during a node shutdown.
+                                type: string
+                              shutdownGracePeriodCriticalPods:
+                                description: |-
+                                  ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+                                  critical pods during a node shutdown.
+                                type: string
+                              systemReserved:
+                                additionalProperties:
+                                  type: string
+                                description: |-
+                                  SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+                                  resources reserved for non-kubernetes components.
+                                type: object
+                              topologyManagerPolicy:
+                                description: TopologyManagerPolicy is the name of
+                                  the topology manager policy to use.
+                                type: string
+                              topologyManagerScope:
+                                description: |-
+                                  TopologyManagerScope represents the scope of topology hint generation
+                                  that topology manager requests and hint providers generate.
+                                type: string
                             type: object
                         type: object
                       bottlerocketAdmin:
@@ -5137,10 +5275,148 @@ spec:
                                 items:
                                   type: string
                                 type: array
+                              clusterDomain:
+                                description: |-
+                                  ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+                                  to search this domain before the hostâ€™s search domains
+                                type: string
+                              containerLogMaxFiles:
+                                description: |-
+                                  ContainerLogMaxFiles specifies the maximum number of container log
+                                  files that can be present for a container
+                                type: integer
+                              containerLogMaxSize:
+                                description: |-
+                                  ContainerLogMaxSize is a quantity defining the maximum size of
+                                  the container log file before it is rotated
+                                type: string
+                              cpuCFSQuota:
+                                description: CPUCFSQuota enables CPU CFS quota enforcement
+                                  for containers that specify CPU limits
+                                type: boolean
+                              cpuManagerPolicy:
+                                description: CPUManagerPolicy is the name of the policy
+                                  to use.
+                                type: string
+                              cpuManagerPolicyOptions:
+                                additionalProperties:
+                                  type: string
+                                description: |-
+                                  CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+                                  fine tune the behaviour of the cpu manager policies
+                                type: object
+                              cpuManagerReconcilePeriod:
+                                description: CPUManagerReconcilePeriod is the reconciliation
+                                  period for the CPU Manager.
+                                type: string
+                              eventBurst:
+                                description: EventBurst is the maximum size of a burst
+                                  of event creations.
+                                type: integer
+                              eventRecordQPS:
+                                description: EventRecordQPS is the maximum event creations
+                                  per second.
+                                type: integer
+                              evictionHard:
+                                additionalProperties:
+                                  type: string
+                                description: EvictionHard is a map of signal names
+                                  to quantities that defines hard eviction thresholds.
+                                type: object
+                              evictionMaxPodGracePeriod:
+                                description: |-
+                                  EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+                                  when terminating pods in response to a soft eviction threshold being met.
+                                type: integer
+                              evictionSoft:
+                                additionalProperties:
+                                  type: string
+                                description: EvictionSoft is a map of signal names
+                                  to quantities that defines soft eviction thresholds.
+                                type: object
+                              evictionSoftGracePeriod:
+                                additionalProperties:
+                                  type: string
+                                description: |-
+                                  EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+                                  for each soft eviction signal.
+                                type: object
+                              imageGCHighThresholdPercent:
+                                description: |-
+                                  ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+                                  collection is always run.
+                                type: integer
+                              imageGCLowThresholdPercent:
+                                description: ImageGCLowThresholdPercent is the percent
+                                  of disk usage before which image garbage collection
+                                  is never run.
+                                type: integer
+                              kubeAPIBurst:
+                                description: KubeAPIBurst  is the burst to allow while
+                                  talking with kubernetes API server.
+                                type: integer
+                              kubeAPIQPS:
+                                description: KubeAPIQPS is the QPS to use while talking
+                                  with kubernetes apiserver.
+                                type: integer
+                              kubeReserved:
+                                additionalProperties:
+                                  type: string
+                                description: |-
+                                  KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+                                  reserved for kubernetes system components
+                                type: object
                               maxPods:
                                 description: MaxPods defines the maximum number of
                                   pods that can run on a node.
                                 type: integer
+                              memoryManagerPolicy:
+                                description: MemoryManagerPolicy is the name of the
+                                  policy to use by memory manager.
+                                type: string
+                              podPidsLimit:
+                                description: PodPidsLimit is the maximum number of
+                                  PIDs in any pod.
+                                format: int64
+                                type: integer
+                              providerID:
+                                description: ProviderID sets the unique ID of the
+                                  instance that an external provider.
+                                type: string
+                              registryBurst:
+                                description: RegistryBurst is the maximum size of
+                                  bursty pulls.
+                                type: integer
+                              registryPullQPS:
+                                description: RegistryPullQPS is the limit of registry
+                                  pulls per second.
+                                type: integer
+                              shutdownGracePeriod:
+                                description: |-
+                                  ShutdownGracePeriod specifies the total duration that the node should delay
+                                  the shutdown and total grace period for pod termination during a node shutdown.
+                                type: string
+                              shutdownGracePeriodCriticalPods:
+                                description: |-
+                                  ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+                                  critical pods during a node shutdown.
+                                type: string
+                              systemReserved:
+                                additionalProperties:
+                                  type: string
+                                description: |-
+                                  SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+                                  resources reserved for non-kubernetes components.
+                                type: object
+                              topologyManagerPolicy:
+                                description: TopologyManagerPolicy is the name of
+                                  the topology manager policy to use.
+                                type: string
+                              topologyManagerScope:
+                                description: |-
+                                  TopologyManagerScope represents the scope of topology hint generation
+                                  that topology manager requests and hint providers generate.
+                                type: string
                             type: object
                         type: object
                       bottlerocketAdmin:
diff --git a/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanetemplates.yaml b/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanetemplates.yaml
index c895e1247..0dba15105 100644
--- a/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanetemplates.yaml
+++ b/controlplane/kubeadm/config/crd/bases/controlplane.cluster.x-k8s.io_kubeadmcontrolplanetemplates.yaml
@@ -1985,10 +1985,152 @@ spec:
                                         items:
                                           type: string
                                         type: array
+                                      clusterDomain:
+                                        description: |-
+                                          ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+                                          to search this domain before the hostâ€™s search domains
+                                        type: string
+                                      containerLogMaxFiles:
+                                        description: |-
+                                          ContainerLogMaxFiles specifies the maximum number of container log
+                                          files that can be present for a container
+                                        type: integer
+                                      containerLogMaxSize:
+                                        description: |-
+                                          ContainerLogMaxSize is a quantity defining the maximum size of
+                                          the container log file before it is rotated
+                                        type: string
+                                      cpuCFSQuota:
+                                        description: CPUCFSQuota enables CPU CFS quota
+                                          enforcement for containers that specify
+                                          CPU limits
+                                        type: boolean
+                                      cpuManagerPolicy:
+                                        description: CPUManagerPolicy is the name
+                                          of the policy to use.
+                                        type: string
+                                      cpuManagerPolicyOptions:
+                                        additionalProperties:
+                                          type: string
+                                        description: |-
+                                          CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+                                          fine tune the behaviour of the cpu manager policies
+                                        type: object
+                                      cpuManagerReconcilePeriod:
+                                        description: CPUManagerReconcilePeriod is
+                                          the reconciliation period for the CPU Manager.
+                                        type: string
+                                      eventBurst:
+                                        description: EventBurst is the maximum size
+                                          of a burst of event creations.
+                                        type: integer
+                                      eventRecordQPS:
+                                        description: EventRecordQPS is the maximum
+                                          event creations per second.
+                                        type: integer
+                                      evictionHard:
+                                        additionalProperties:
+                                          type: string
+                                        description: EvictionHard is a map of signal
+                                          names to quantities that defines hard eviction
+                                          thresholds.
+                                        type: object
+                                      evictionMaxPodGracePeriod:
+                                        description: |-
+                                          EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+                                          when terminating pods in response to a soft eviction threshold being met.
+                                        type: integer
+                                      evictionSoft:
+                                        additionalProperties:
+                                          type: string
+                                        description: EvictionSoft is a map of signal
+                                          names to quantities that defines soft eviction
+                                          thresholds.
+                                        type: object
+                                      evictionSoftGracePeriod:
+                                        additionalProperties:
+                                          type: string
+                                        description: |-
+                                          EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+                                          for each soft eviction signal.
+                                        type: object
+                                      imageGCHighThresholdPercent:
+                                        description: |-
+                                          ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+                                          collection is always run.
+                                        type: integer
+                                      imageGCLowThresholdPercent:
+                                        description: ImageGCLowThresholdPercent is
+                                          the percent of disk usage before which image
+                                          garbage collection is never run.
+                                        type: integer
+                                      kubeAPIBurst:
+                                        description: KubeAPIBurst  is the burst to
+                                          allow while talking with kubernetes API
+                                          server.
+                                        type: integer
+                                      kubeAPIQPS:
+                                        description: KubeAPIQPS is the QPS to use
+                                          while talking with kubernetes apiserver.
+                                        type: integer
+                                      kubeReserved:
+                                        additionalProperties:
+                                          type: string
+                                        description: |-
+                                          KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+                                          reserved for kubernetes system components
+                                        type: object
                                       maxPods:
                                         description: MaxPods defines the maximum number
                                           of pods that can run on a node.
                                         type: integer
+                                      memoryManagerPolicy:
+                                        description: MemoryManagerPolicy is the name
+                                          of the policy to use by memory manager.
+                                        type: string
+                                      podPidsLimit:
+                                        description: PodPidsLimit is the maximum number
+                                          of PIDs in any pod.
+                                        format: int64
+                                        type: integer
+                                      providerID:
+                                        description: ProviderID sets the unique ID
+                                          of the instance that an external provider.
+                                        type: string
+                                      registryBurst:
+                                        description: RegistryBurst is the maximum
+                                          size of bursty pulls.
+                                        type: integer
+                                      registryPullQPS:
+                                        description: RegistryPullQPS is the limit
+                                          of registry pulls per second.
+                                        type: integer
+                                      shutdownGracePeriod:
+                                        description: |-
+                                          ShutdownGracePeriod specifies the total duration that the node should delay
+                                          the shutdown and total grace period for pod termination during a node shutdown.
+                                        type: string
+                                      shutdownGracePeriodCriticalPods:
+                                        description: |-
+                                          ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+                                          critical pods during a node shutdown.
+                                        type: string
+                                      systemReserved:
+                                        additionalProperties:
+                                          type: string
+                                        description: |-
+                                          SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+                                          resources reserved for non-kubernetes components.
+                                        type: object
+                                      topologyManagerPolicy:
+                                        description: TopologyManagerPolicy is the
+                                          name of the topology manager policy to use.
+                                        type: string
+                                      topologyManagerScope:
+                                        description: |-
+                                          TopologyManagerScope represents the scope of topology hint generation
+                                          that topology manager requests and hint providers generate.
+                                        type: string
                                     type: object
                                 type: object
                               bottlerocketAdmin:
@@ -3362,10 +3504,152 @@ spec:
                                         items:
                                           type: string
                                         type: array
+                                      clusterDomain:
+                                        description: |-
+                                          ClusterDomain defines the DNS domain for the cluster, allowing all Kubernetes-run containers
+                                          to search this domain before the hostâ€™s search domains
+                                        type: string
+                                      containerLogMaxFiles:
+                                        description: |-
+                                          ContainerLogMaxFiles specifies the maximum number of container log
+                                          files that can be present for a container
+                                        type: integer
+                                      containerLogMaxSize:
+                                        description: |-
+                                          ContainerLogMaxSize is a quantity defining the maximum size of
+                                          the container log file before it is rotated
+                                        type: string
+                                      cpuCFSQuota:
+                                        description: CPUCFSQuota enables CPU CFS quota
+                                          enforcement for containers that specify
+                                          CPU limits
+                                        type: boolean
+                                      cpuManagerPolicy:
+                                        description: CPUManagerPolicy is the name
+                                          of the policy to use.
+                                        type: string
+                                      cpuManagerPolicyOptions:
+                                        additionalProperties:
+                                          type: string
+                                        description: |-
+                                          CPUManagerPolicyOptions is a set of key=value which allows to set extra options to
+                                          fine tune the behaviour of the cpu manager policies
+                                        type: object
+                                      cpuManagerReconcilePeriod:
+                                        description: CPUManagerReconcilePeriod is
+                                          the reconciliation period for the CPU Manager.
+                                        type: string
+                                      eventBurst:
+                                        description: EventBurst is the maximum size
+                                          of a burst of event creations.
+                                        type: integer
+                                      eventRecordQPS:
+                                        description: EventRecordQPS is the maximum
+                                          event creations per second.
+                                        type: integer
+                                      evictionHard:
+                                        additionalProperties:
+                                          type: string
+                                        description: EvictionHard is a map of signal
+                                          names to quantities that defines hard eviction
+                                          thresholds.
+                                        type: object
+                                      evictionMaxPodGracePeriod:
+                                        description: |-
+                                          EvictionMaxPodGracePeriod is the maximum allowed grace period (in seconds) to use
+                                          when terminating pods in response to a soft eviction threshold being met.
+                                        type: integer
+                                      evictionSoft:
+                                        additionalProperties:
+                                          type: string
+                                        description: EvictionSoft is a map of signal
+                                          names to quantities that defines soft eviction
+                                          thresholds.
+                                        type: object
+                                      evictionSoftGracePeriod:
+                                        additionalProperties:
+                                          type: string
+                                        description: |-
+                                          EvictionSoftGracePeriod is a map of signal names to quantities that defines grace periods
+                                          for each soft eviction signal.
+                                        type: object
+                                      imageGCHighThresholdPercent:
+                                        description: |-
+                                          ImageGCHighThresholdPercent is the percent of disk usage after which image garbage
+                                          collection is always run.
+                                        type: integer
+                                      imageGCLowThresholdPercent:
+                                        description: ImageGCLowThresholdPercent is
+                                          the percent of disk usage before which image
+                                          garbage collection is never run.
+                                        type: integer
+                                      kubeAPIBurst:
+                                        description: KubeAPIBurst  is the burst to
+                                          allow while talking with kubernetes API
+                                          server.
+                                        type: integer
+                                      kubeAPIQPS:
+                                        description: KubeAPIQPS is the QPS to use
+                                          while talking with kubernetes apiserver.
+                                        type: integer
+                                      kubeReserved:
+                                        additionalProperties:
+                                          type: string
+                                        description: |-
+                                          KubeReserved is a set of ResourceName=ResourceQuantity pairs that describe resources
+                                          reserved for kubernetes system components
+                                        type: object
                                       maxPods:
                                         description: MaxPods defines the maximum number
                                           of pods that can run on a node.
                                         type: integer
+                                      memoryManagerPolicy:
+                                        description: MemoryManagerPolicy is the name
+                                          of the policy to use by memory manager.
+                                        type: string
+                                      podPidsLimit:
+                                        description: PodPidsLimit is the maximum number
+                                          of PIDs in any pod.
+                                        format: int64
+                                        type: integer
+                                      providerID:
+                                        description: ProviderID sets the unique ID
+                                          of the instance that an external provider.
+                                        type: string
+                                      registryBurst:
+                                        description: RegistryBurst is the maximum
+                                          size of bursty pulls.
+                                        type: integer
+                                      registryPullQPS:
+                                        description: RegistryPullQPS is the limit
+                                          of registry pulls per second.
+                                        type: integer
+                                      shutdownGracePeriod:
+                                        description: |-
+                                          ShutdownGracePeriod specifies the total duration that the node should delay
+                                          the shutdown and total grace period for pod termination during a node shutdown.
+                                        type: string
+                                      shutdownGracePeriodCriticalPods:
+                                        description: |-
+                                          ShutdownGracePeriodCriticalPods specifies the duration used to terminate
+                                          critical pods during a node shutdown.
+                                        type: string
+                                      systemReserved:
+                                        additionalProperties:
+                                          type: string
+                                        description: |-
+                                          SystemReserved is a set of ResourceName=ResourceQuantity pairs that describe
+                                          resources reserved for non-kubernetes components.
+                                        type: object
+                                      topologyManagerPolicy:
+                                        description: TopologyManagerPolicy is the
+                                          name of the topology manager policy to use.
+                                        type: string
+                                      topologyManagerScope:
+                                        description: |-
+                                          TopologyManagerScope represents the scope of topology hint generation
+                                          that topology manager requests and hint providers generate.
+                                        type: string
                                     type: object
                                 type: object
                               bottlerocketAdmin:
diff --git a/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.conversion.go b/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.conversion.go
index f9d81b94b..722ffdf23 100644
--- a/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.conversion.go
+++ b/internal/apis/bootstrap/kubeadm/v1alpha4/zz_generated.conversion.go
@@ -868,19 +868,50 @@ func Convert_v1alpha4_BottlerocketKubernetesSettings_To_v1beta1_BottlerocketKube
 }
 
 func autoConvert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(in *v1beta1.BottlerocketKubernetesSettings, out *BottlerocketKubernetesSettings, s conversion.Scope) error {
-	out.MaxPods = in.MaxPods
 	out.AllowedUnsafeSysctls = *(*[]string)(unsafe.Pointer(&in.AllowedUnsafeSysctls))
 	out.ClusterDNSIPs = *(*[]string)(unsafe.Pointer(&in.ClusterDNSIPs))
+	// WARNING: in.ClusterDomain requires manual conversion: does not exist in peer-type
+	// WARNING: in.ContainerLogMaxFiles requires manual conversion: does not exist in peer-type
+	// WARNING: in.ContainerLogMaxSize requires manual conversion: does not exist in peer-type
+	// WARNING: in.CPUCFSQuota requires manual conversion: does not exist in peer-type
+	// WARNING: in.CPUManagerPolicy requires manual conversion: does not exist in peer-type
+	// WARNING: in.CPUManagerPolicyOptions requires manual conversion: does not exist in peer-type
+	// WARNING: in.CPUManagerReconcilePeriod requires manual conversion: does not exist in peer-type
+	// WARNING: in.EventBurst requires manual conversion: does not exist in peer-type
+	// WARNING: in.EventRecordQPS requires manual conversion: does not exist in peer-type
+	// WARNING: in.EvictionHard requires manual conversion: does not exist in peer-type
+	// WARNING: in.EvictionMaxPodGracePeriod requires manual conversion: does not exist in peer-type
+	// WARNING: in.EvictionSoft requires manual conversion: does not exist in peer-type
+	// WARNING: in.EvictionSoftGracePeriod requires manual conversion: does not exist in peer-type
+	// WARNING: in.ImageGCHighThresholdPercent requires manual conversion: does not exist in peer-type
+	// WARNING: in.ImageGCLowThresholdPercent requires manual conversion: does not exist in peer-type
+	// WARNING: in.KubeAPIBurst requires manual conversion: does not exist in peer-type
+	// WARNING: in.KubeAPIQPS requires manual conversion: does not exist in peer-type
+	// WARNING: in.KubeReserved requires manual conversion: does not exist in peer-type
+	out.MaxPods = in.MaxPods
+	// WARNING: in.MemoryManagerPolicy requires manual conversion: does not exist in peer-type
+	// WARNING: in.PodPidsLimit requires manual conversion: does not exist in peer-type
+	// WARNING: in.ProviderID requires manual conversion: does not exist in peer-type
+	// WARNING: in.RegistryBurst requires manual conversion: does not exist in peer-type
+	// WARNING: in.RegistryPullQPS requires manual conversion: does not exist in peer-type
+	// WARNING: in.ShutdownGracePeriod requires manual conversion: does not exist in peer-type
+	// WARNING: in.ShutdownGracePeriodCriticalPods requires manual conversion: does not exist in peer-type
+	// WARNING: in.SystemReserved requires manual conversion: does not exist in peer-type
+	// WARNING: in.TopologyManagerPolicy requires manual conversion: does not exist in peer-type
+	// WARNING: in.TopologyManagerScope requires manual conversion: does not exist in peer-type
 	return nil
 }
 
-// Convert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings is an autogenerated conversion function.
-func Convert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(in *v1beta1.BottlerocketKubernetesSettings, out *BottlerocketKubernetesSettings, s conversion.Scope) error {
-	return autoConvert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(in, out, s)
-}
-
 func autoConvert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(in *BottlerocketSettings, out *v1beta1.BottlerocketSettings, s conversion.Scope) error {
-	out.Kubernetes = (*v1beta1.BottlerocketKubernetesSettings)(unsafe.Pointer(in.Kubernetes))
+	if in.Kubernetes != nil {
+		in, out := &in.Kubernetes, &out.Kubernetes
+		*out = new(v1beta1.BottlerocketKubernetesSettings)
+		if err := Convert_v1alpha4_BottlerocketKubernetesSettings_To_v1beta1_BottlerocketKubernetesSettings(*in, *out, s); err != nil {
+			return err
+		}
+	} else {
+		out.Kubernetes = nil
+	}
 	out.Kernel = (*v1beta1.BottlerocketKernelSettings)(unsafe.Pointer(in.Kernel))
 	out.Boot = (*v1beta1.BottlerocketBootSettings)(unsafe.Pointer(in.Boot))
 	return nil
@@ -891,8 +922,21 @@ func Convert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(in *B
 	return autoConvert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(in, out, s)
 }
 
+// Convert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings is an autogenerated conversion function.
+func Convert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(in *v1beta1.BottlerocketKubernetesSettings, out *BottlerocketKubernetesSettings, s conversion.Scope) error {
+	return autoConvert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(in, out, s)
+}
+
 func autoConvert_v1beta1_BottlerocketSettings_To_v1alpha4_BottlerocketSettings(in *v1beta1.BottlerocketSettings, out *BottlerocketSettings, s conversion.Scope) error {
-	out.Kubernetes = (*BottlerocketKubernetesSettings)(unsafe.Pointer(in.Kubernetes))
+	if in.Kubernetes != nil {
+		in, out := &in.Kubernetes, &out.Kubernetes
+		*out = new(BottlerocketKubernetesSettings)
+		if err := Convert_v1beta1_BottlerocketKubernetesSettings_To_v1alpha4_BottlerocketKubernetesSettings(*in, *out, s); err != nil {
+			return err
+		}
+	} else {
+		out.Kubernetes = nil
+	}
 	out.Kernel = (*BottlerocketKernelSettings)(unsafe.Pointer(in.Kernel))
 	out.Boot = (*BottlerocketBootSettings)(unsafe.Pointer(in.Boot))
 	return nil
@@ -970,7 +1014,15 @@ func autoConvert_v1alpha4_ClusterConfiguration_To_v1beta1_ClusterConfiguration(i
 	out.ClusterName = in.ClusterName
 	out.BottlerocketHostContainers = *(*[]v1beta1.BottlerocketHostContainer)(unsafe.Pointer(&in.BottlerocketHostContainers))
 	out.BottlerocketCustomBootstrapContainers = *(*[]v1beta1.BottlerocketBootstrapContainer)(unsafe.Pointer(&in.BottlerocketCustomBootstrapContainers))
-	out.Bottlerocket = (*v1beta1.BottlerocketSettings)(unsafe.Pointer(in.Bottlerocket))
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(v1beta1.BottlerocketSettings)
+		if err := Convert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(*in, *out, s); err != nil {
+			return err
+		}
+	} else {
+		out.Bottlerocket = nil
+	}
 	out.CertBundles = *(*[]v1beta1.CertBundle)(unsafe.Pointer(&in.CertBundles))
 	return nil
 }
@@ -1025,7 +1077,15 @@ func autoConvert_v1beta1_ClusterConfiguration_To_v1alpha4_ClusterConfiguration(i
 	out.ClusterName = in.ClusterName
 	out.BottlerocketHostContainers = *(*[]BottlerocketHostContainer)(unsafe.Pointer(&in.BottlerocketHostContainers))
 	out.BottlerocketCustomBootstrapContainers = *(*[]BottlerocketBootstrapContainer)(unsafe.Pointer(&in.BottlerocketCustomBootstrapContainers))
-	out.Bottlerocket = (*BottlerocketSettings)(unsafe.Pointer(in.Bottlerocket))
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(BottlerocketSettings)
+		if err := Convert_v1beta1_BottlerocketSettings_To_v1alpha4_BottlerocketSettings(*in, *out, s); err != nil {
+			return err
+		}
+	} else {
+		out.Bottlerocket = nil
+	}
 	out.CertBundles = *(*[]CertBundle)(unsafe.Pointer(&in.CertBundles))
 	return nil
 }
@@ -1426,7 +1486,15 @@ func autoConvert_v1alpha4_JoinConfiguration_To_v1beta1_JoinConfiguration(in *Joi
 	out.ControlPlane = (*v1beta1.JoinControlPlane)(unsafe.Pointer(in.ControlPlane))
 	out.BottlerocketCustomHostContainers = *(*[]v1beta1.BottlerocketHostContainer)(unsafe.Pointer(&in.BottlerocketCustomHostContainers))
 	out.BottlerocketCustomBootstrapContainers = *(*[]v1beta1.BottlerocketBootstrapContainer)(unsafe.Pointer(&in.BottlerocketCustomBootstrapContainers))
-	out.Bottlerocket = (*v1beta1.BottlerocketSettings)(unsafe.Pointer(in.Bottlerocket))
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(v1beta1.BottlerocketSettings)
+		if err := Convert_v1alpha4_BottlerocketSettings_To_v1beta1_BottlerocketSettings(*in, *out, s); err != nil {
+			return err
+		}
+	} else {
+		out.Bottlerocket = nil
+	}
 	out.CertBundles = *(*[]v1beta1.CertBundle)(unsafe.Pointer(&in.CertBundles))
 	return nil
 }
@@ -1467,7 +1535,15 @@ func autoConvert_v1beta1_JoinConfiguration_To_v1alpha4_JoinConfiguration(in *v1b
 	// WARNING: in.Patches requires manual conversion: does not exist in peer-type
 	out.BottlerocketCustomHostContainers = *(*[]BottlerocketHostContainer)(unsafe.Pointer(&in.BottlerocketCustomHostContainers))
 	out.BottlerocketCustomBootstrapContainers = *(*[]BottlerocketBootstrapContainer)(unsafe.Pointer(&in.BottlerocketCustomBootstrapContainers))
-	out.Bottlerocket = (*BottlerocketSettings)(unsafe.Pointer(in.Bottlerocket))
+	if in.Bottlerocket != nil {
+		in, out := &in.Bottlerocket, &out.Bottlerocket
+		*out = new(BottlerocketSettings)
+		if err := Convert_v1beta1_BottlerocketSettings_To_v1alpha4_BottlerocketSettings(*in, *out, s); err != nil {
+			return err
+		}
+	} else {
+		out.Bottlerocket = nil
+	}
 	out.CertBundles = *(*[]CertBundle)(unsafe.Pointer(&in.CertBundles))
 	return nil
 }
-- 
2.45.2

